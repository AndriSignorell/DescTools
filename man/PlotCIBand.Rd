% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/PlotCIBand.R
\name{PlotCIBand}
\alias{PlotCIBand}
\title{Confidence band and estimator line (base R)}
\usage{
PlotCIBand(
  x,
  y = NULL,
  col_band = SetAlpha("grey"),
  col_line = hred,
  lwd = 2,
  lty = 1,
  band_border = NA,
  sort_x = TRUE,
  add = FALSE,
  ...
)
}
\arguments{
\item{x}{Numeric vector of x values.}

\item{y}{3-column matrix of estimator values (e.g., mean/predicted) and
lower/upper confidence interval.}

\item{col_band}{Fill color for the confidence band.
Default: \code{grDevices::adjustcolor("grey", alpha.f = 0.35)}.}

\item{col_line}{Line color for the estimator. Default: \code{"blue"}.}

\item{lwd}{Line width for the estimator line. Default: \code{2}.}

\item{lty}{Line type for the estimator line. Default: \code{1}.}

\item{band_border}{Border color for the band polygon (use \code{NA} for no border).}

\item{sort_x}{Logical; if \code{TRUE}, data are sorted by \code{x} so that
the polygon does not self-intersect. Default: \code{TRUE}.}

\item{add}{Logical; if \code{TRUE}, draw into an existing plot and do not
set up a new one. Default: \code{FALSE}.}

\item{...}{Additional graphical parameters that (only when \code{add = FALSE})
are passed to \code{plot()} (e.g., \code{xlab}, \code{ylab}, \code{main},
\code{xlim}, \code{ylim}, \code{axes}).}
}
\value{
Invisibly returns a list with the (possibly sorted and NA-filtered) vectors:
\code{list(x = x, fit = yhat, lower = low, upper = high)}.
}
\description{
Draws a confidence band (lower/upper limits) and an estimator line
into an existing plot or, if needed, sets up a new plot.
}
\details{
If \code{add = FALSE}, an empty plot is created with \code{type = "n"},
then the band is drawn via \code{polygon()} and the estimator via \code{lines()}.
The y-axis limits (\code{ylim}) are set to \code{range(low, high)} only if
no \code{ylim} was supplied via \code{...}. Missing values in \code{x},
\code{yhat}, \code{low}, \code{high} are removed; if fewer than two points
remain, the function aborts.

If \code{add = TRUE}, axis limits are not modified; drawing is done on the
current device.
}
\examples{
set.seed(1)
x <- 1:50
fit <- sin(x/8) + rnorm(50, 0, 0.05)
se  <- 0.15
low <- fit - 1.96 * se
high <- fit + 1.96 * se

# 1) Standalone (sets up the plot):
PlotCIBand(x, cbind(fit, low, high),
  col_band = grDevices::adjustcolor("grey70", 0.4),
  col_line = "black", lwd = 2,
  xlab = "x", ylab = "y", main = "Estimator with 95\% CI")

# 2) Add to an existing plot:
plot(x, fit, type = "n", xlab = "x", ylab = "y")
PlotCIBand(cbind(fit, low, high), add = TRUE)

}
\seealso{
\code{\link{PlotDotCI}} for plotting confidence intervals
}
