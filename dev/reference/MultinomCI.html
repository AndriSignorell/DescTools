<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Confidence Intervals for Multinomial Proportions — MultinomCI • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Confidence Intervals for Multinomial Proportions — MultinomCI" />
<meta property="og:description" content="Confidence intervals for multinomial proportions are often approximated by single binomial confidence intervals, which might in practice often yield satisfying results, but is properly speaking not correct. This function calculates simultaneous confidence intervals for multinomial proportions either according to the methods of Sison and Glaz, Goodman, Wald, Wald with continuity correction or Wilson." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.41.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/">In-development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence Intervals for Multinomial Proportions</h1>
    
    <div class="hidden name"><code>MultinomCI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Confidence intervals for multinomial proportions are often approximated by single binomial confidence intervals, which might in practice often yield satisfying results, but is properly speaking not correct. This function calculates simultaneous confidence intervals for multinomial proportions either according to the methods of Sison and Glaz, Goodman, Wald, Wald with continuity correction or Wilson.</p>
    </div>

    <pre class="usage"><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, conf.level <span class='op'>=</span> <span class='fl'>0.95</span>, sides <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>, <span class='st'>"left"</span>, <span class='st'>"right"</span><span class='op'>)</span>,
           method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"sisonglaz"</span>, <span class='st'>"cplus1"</span>, <span class='st'>"goodman"</span>, <span class='st'>"wald"</span>, <span class='st'>"waldcc"</span>, <span class='st'>"wilson"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A vector of positive integers representing the number of occurrences of each class. The total number of samples equals the sum of such elements.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>confidence level, defaults to 0.95.</p></td>
    </tr>
    <tr>
      <th>sides</th>
      <td><p>a character string specifying the side of the confidence interval, must be one of <code>"two.sided"</code> (default),
<code>"left"</code> or <code>"right"</code>. You can specify just the initial letter. <code>"left"</code> would be analogue to a hypothesis of
<code>"greater"</code> in a <code>t.test</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>character string specifing which method to use; can be one out of
  <code>"sisonglaz"</code>, <code>"cplus1"</code>, <code>"goodman"</code>,  <code>"wald"</code>,  <code>"waldcc"</code>, <code>"wilson"</code>.
  Method can be abbreviated. See details. Defaults to <code>"sisonglaz"</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Pablo J. Villacorta Iglesias &lt;pjvi@decsai.ugr.es&gt;<br />
Department of Computer Science and Artificial Intelligence, University of Granada (Spain)
(Sison-Glaz)</p>
<p>Andri Signorell &lt;andri@signorell.net&gt;
(Goodman, Wald, Wilson)</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Given a vector of observations with the number of samples falling in each class of a multinomial distribution,
builds the simultaneous confidence intervals for the multinomial probabilities according to the method proposed by the mentioned authors.
The R code for Sison and Glaz (1995) has been translated from thes SAS code written by May and Johnson (2000).<br />
Some approaches for the confidence intervals can potentially yield negative results or values beyond 1. These would be reset such as not to exceed the range of [0, 1].</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix with 3 columns:</p>
<dt>est</dt><dd><p>estimate</p></dd>
  <dt>lwr.ci</dt><dd><p>lower bound of the confidence interval</p></dd>
  <dt>upr.ci</dt><dd><p>upper bound of the confidence interval</p></dd>

The number of rows correspond to the dimension of x.


    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sison, C.P and Glaz, J. (1995) Simultaneous confidence intervals and sample size determination
for multinomial proportions. <em>Journal of the American Statistical Association</em>, 90:366-369.</p>
<p>Glaz, J., Sison, C.P. (1999) Simultaneous confidence intervals for multinomial proportions.
<em>Journal of Statistical Planning and Inference</em> 82:251-262.</p>
<p>May, W.L., Johnson, W.D.(2000) Constructing two-sided simultaneous confidence intervals for
multinomial proportions for small counts in a large number of cells. <em>Journal of Statistical Software</em> 5(6) .
Paper and code available at <a href='https://www.jstatsoft.org/v05/i06'>https://www.jstatsoft.org/v05/i06</a>.</p>
<p>Goodman, L. A. (1965) On Simultaneous Confidence Intervals for Multinomial
Proportions <em>Technometrics</em>, 7, 247-254.</p>
<p>Wald, A. Tests of statistical hypotheses concerning several parameters when the number of observations is large, <em>Trans. Am. Math. Soc.</em> 54 (1943) 426-482.</p>
<p>Wilson, E. B. Probable inference, the law of succession and statistical inference, <em>J.Am. Stat. Assoc.</em> 22 (1927) 209-212.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Multinomial distribution with 3 classes, from which a sample of 79 elements</span>
<span class='co'># were drawn: 23 of them belong to the first class, 12 to the</span>
<span class='co'># second class and 44 to the third class. Punctual estimations</span>
<span class='co'># of the probabilities from this sample would be 23/79, 12/79</span>
<span class='co'># and 44/79 but we want to build 95% simultaneous confidence intervals</span>
<span class='co'># for the true probabilities</span>

<span class='fu'>MultinomCI</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>23</span>, <span class='fl'>12</span>, <span class='fl'>44</span><span class='op'>)</span>, conf.level<span class='op'>=</span><span class='fl'>0.95</span><span class='op'>)</span>
</div><div class='output co'>#&gt;            est     lwr.ci    upr.ci
#&gt; [1,] 0.2911392 0.18987342 0.4104183
#&gt; [2,] 0.1518987 0.05063291 0.2711778
#&gt; [3,] 0.5569620 0.45569620 0.6762410</div><div class='input'>

<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>35</span>, <span class='fl'>74</span>, <span class='fl'>22</span>, <span class='fl'>69</span><span class='op'>)</span>

<span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"goodman"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est     lwr.ci    upr.ci
#&gt; [1,] 0.175 0.11253215 0.2619106
#&gt; [2,] 0.370 0.28113643 0.4686407
#&gt; [3,] 0.110 0.06224338 0.1870880
#&gt; [4,] 0.345 0.25846198 0.4431954</div><div class='input'><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"sisonglaz"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est lwr.ci    upr.ci
#&gt; [1,] 0.175  0.105 0.2512563
#&gt; [2,] 0.370  0.300 0.4462563
#&gt; [3,] 0.110  0.040 0.1862563
#&gt; [4,] 0.345  0.275 0.4212563</div><div class='input'><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"cplus1"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est lwr.ci upr.ci
#&gt; [1,] 0.175  0.100  0.250
#&gt; [2,] 0.370  0.295  0.445
#&gt; [3,] 0.110  0.035  0.185
#&gt; [4,] 0.345  0.270  0.420</div><div class='input'><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"wald"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est     lwr.ci    upr.ci
#&gt; [1,] 0.175 0.12234021 0.2276598
#&gt; [2,] 0.370 0.30308797 0.4369120
#&gt; [3,] 0.110 0.06663649 0.1533635
#&gt; [4,] 0.345 0.27911853 0.4108815</div><div class='input'><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"waldcc"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est     lwr.ci    upr.ci
#&gt; [1,] 0.175 0.11984021 0.2301598
#&gt; [2,] 0.370 0.30058797 0.4394120
#&gt; [3,] 0.110 0.06413649 0.1558635
#&gt; [4,] 0.345 0.27661853 0.4133815</div><div class='input'><span class='fu'>MultinomCI</span><span class='op'>(</span><span class='va'>x</span>, method<span class='op'>=</span><span class='st'>"wilson"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;        est     lwr.ci    upr.ci
#&gt; [1,] 0.175 0.12860515 0.2336443
#&gt; [2,] 0.370 0.30612608 0.4387737
#&gt; [3,] 0.110 0.07377244 0.1609269
#&gt; [4,] 0.345 0.28259794 0.4132441</div><div class='input'>
<span class='co'># compare to</span>
<span class='fu'><a href='BinomCI.html'>BinomCI</a></span><span class='op'>(</span><span class='va'>x</span>, n<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       est     lwr.ci    upr.ci
#&gt; x.1 0.175 0.12860515 0.2336443
#&gt; x.2 0.370 0.30612608 0.4387737
#&gt; x.3 0.110 0.07377244 0.1609269
#&gt; x.4 0.345 0.28259794 0.4132441</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


