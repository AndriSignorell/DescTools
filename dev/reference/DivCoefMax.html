<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Maximal value of Rao's diversity coefficient also called 
quadratic entropy — DivCoefMax • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Maximal value of Rao's diversity coefficient also called 
quadratic entropy — DivCoefMax" />
<meta property="og:description" content="For a given dissimilarity matrix, this function calculates the 
maximal value of Rao's diversity coefficient over all frequency 
distribution. It uses an optimization technique based on Rosen's 
projection gradient algorithm and is verified using the 
Kuhn-Tucker conditions." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.40.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Maximal value of Rao's diversity coefficient also called 
quadratic entropy</h1>
    
    <div class="hidden name"><code>DivCoefMax.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For a given dissimilarity matrix, this function calculates the 
maximal value of Rao's diversity coefficient over all frequency 
distribution. It uses an optimization technique based on Rosen's 
projection gradient algorithm and is verified using the 
Kuhn-Tucker conditions.</p>
    </div>

    <pre class="usage"><span class='fu'>DivCoefMax</span><span class='op'>(</span><span class='va'>dis</span>, <span class='va'>epsilon</span>, <span class='va'>comment</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dis</th>
      <td><p>an object of class <code>dist</code> containing distances 
  or dissimilarities among elements.</p></td>
    </tr>
    <tr>
      <th>epsilon</th>
      <td><p>a tolerance threshold : a frequency is non null 
  if it is higher than epsilon.</p></td>
    </tr>
    <tr>
      <th>comment</th>
      <td><p>a logical value indicating whether or not 
  comments on the optimization technique should be printed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list</p>
<dt>value</dt><dd><p>the maximal value of Rao's diversity coefficient.</p></dd>
  <dt>vectors</dt><dd><p>a data frame containing four frequency 
  distributions : sim is a simple distribution which is equal 
  to \(\frac{D1}{1^tD1}\), pro is equal to 
  \(\frac{z}{1^tz1}\), where z is the nonnegative 
  eigenvector of the matrix containing the squared dissimilarities 
  among the elements, met is equal to \(z^2\), num is a frequency 
  vector maximizing Rao's diversity coefficient.</p></dd>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Rao, C.R. (1982) Diversity and dissimilarity coefficients: 
a unified approach. <em>Theoretical Population Biology</em>, 
<b>21</b>, 24--43.</p>
<p>Gini, C. (1912) Variabilita e mutabilita. 
<em>Universite di Cagliari III</em>, Parte II.</p>
<p>Simpson, E.H. (1949) Measurement of diversity. 
<em>Nature</em>, <b>163</b>, 688.</p>
<p>Champely, S. and Chessel, D. (2002) Measuring biological diversity 
using Euclidean metrics. <em>Environmental and Ecological Statistics</em>, 
<b>9</b>, 167--177.</p>
<p>Pavoine, S., Ollier, S. and Pontier, D. (2005) 
Measuring diversity from dissimilarities with Rao's quadratic entropy: 
are any dissimilarities suitable? <em>Theoretical Population Biology</em>,
<b>67</b>, 231--239.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stéphane Champely &lt;Stephane.Champely@univ-lyon1.fr&gt; <br />
Sandrine Pavoine &lt;pavoine@biomserv.univ-lyon1.fr&gt;</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='va'>par.safe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>$</span><span class='va'>mar</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>elec88</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span>, <span class='fl'>0.1</span><span class='op'>)</span><span class='op'>)</span>
<span class='co'># Departments of France.</span>
<span class='fu'>area.plot</span><span class='op'>(</span><span class='va'>elec88</span><span class='op'>$</span><span class='va'>area</span><span class='op'>)</span>

<span class='co'># Dissimilarity matrix.</span>
<span class='va'>d0</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>elec88</span><span class='op'>$</span><span class='va'>xy</span><span class='op'>)</span>

<span class='co'># Frequency distribution maximizing spatial diversity in France</span>
<span class='co'># according to Rao's quadratic entropy.</span>
<span class='va'>France.m</span> <span class='op'>&lt;-</span> <span class='fu'>DivCoefMax</span><span class='op'>(</span><span class='va'>d0</span><span class='op'>)</span>
<span class='va'>w0</span> <span class='op'>&lt;-</span> <span class='va'>France.m</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>$</span><span class='va'>num</span>
<span class='va'>v0</span> <span class='op'>&lt;-</span> <span class='va'>France.m</span><span class='op'>$</span><span class='va'>value</span>
<span class='op'>(</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>94</span><span class='op'>)</span> <span class='op'>[</span><span class='va'>w0</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>]</span>

<span class='co'># Smallest circle including all the 94 departments.</span>
<span class='co'># The squared radius of that circle is the maximal value of the</span>
<span class='co'># spatial diversity.</span>
<span class='va'>w1</span> <span class='op'>=</span> <span class='va'>elec88</span><span class='op'>$</span><span class='va'>xy</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>28</span>, <span class='fl'>66</span><span class='op'>)</span>, <span class='op'>]</span>
<span class='va'>w.c</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>w1</span> <span class='op'>*</span> <span class='va'>w0</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>6</span>, <span class='fl'>28</span>, <span class='fl'>66</span><span class='op'>)</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='va'>sum</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/symbols.html'>symbols</a></span><span class='op'>(</span><span class='va'>w.c</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>, <span class='va'>w.c</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>, circles <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>v0</span><span class='op'>)</span>, inc <span class='op'>=</span> <span class='cn'>FALSE</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'>s.value</span><span class='op'>(</span><span class='va'>elec88</span><span class='op'>$</span><span class='va'>xy</span>, <span class='va'>w0</span>, add.plot <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mar <span class='op'>=</span> <span class='va'>par.safe</span><span class='op'>)</span>


<span class='co'># Maximisation of Rao's diversity coefficient</span>
<span class='co'># with ultrametric dissimilarities.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>microsatt</span><span class='op'>)</span>
<span class='va'>mic.genet</span> <span class='op'>&lt;-</span> <span class='fu'>count2genet</span><span class='op'>(</span><span class='va'>microsatt</span><span class='op'>$</span><span class='va'>tab</span><span class='op'>)</span>
<span class='va'>mic.dist</span> <span class='op'>&lt;-</span> <span class='fu'>dist.genet</span><span class='op'>(</span><span class='va'>mic.genet</span>, <span class='fl'>1</span><span class='op'>)</span>
<span class='va'>mic.phylog</span> <span class='op'>&lt;-</span> <span class='fu'>hclust2phylog</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/hclust.html'>hclust</a></span><span class='op'>(</span><span class='va'>mic.dist</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>plot.phylog</span><span class='op'>(</span><span class='va'>mic.phylog</span><span class='op'>)</span>
<span class='va'>mic.maxpond</span> <span class='op'>&lt;-</span> <span class='fu'>DivCoefMax</span><span class='op'>(</span><span class='va'>mic.phylog</span><span class='op'>$</span><span class='va'>Wdist</span><span class='op'>)</span><span class='op'>$</span><span class='va'>vectors</span><span class='op'>$</span><span class='va'>num</span>
<span class='fu'>dotchart.phylog</span><span class='op'>(</span><span class='va'>mic.phylog</span>, <span class='va'>mic.maxpond</span><span class='op'>)</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


