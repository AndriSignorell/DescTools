<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Durbin-Watson Test — DurbinWatsonTest • DescTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Durbin-Watson Test — DurbinWatsonTest"><meta property="og:description" content="Performs the Durbin-Watson test for autocorrelation of disturbances."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.57.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>


    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf" class="external-link">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf" class="external-link">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf" class="external-link">Combinatorics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AndriSignorell/DescTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Durbin-Watson Test</h1>

    <div class="hidden name"><code>DurbinWatsonTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs the Durbin-Watson test for autocorrelation of disturbances.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">DurbinWatsonTest</span><span class="op">(</span><span class="va">formula</span>, order.by <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                 alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"greater"</span>, <span class="st">"two.sided"</span>, <span class="st">"less"</span><span class="op">)</span>,</span>
<span>                 iterations <span class="op">=</span> <span class="fl">15</span>, exact <span class="op">=</span> <span class="cn">NULL</span>, tol <span class="op">=</span> <span class="fl">1e-10</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>a symbolic description for the model to be tested
    (or a fitted <code>"lm"</code> object).</p></dd>

 <dt id="arg-order-by">order.by<a class="anchor" aria-label="anchor" href="#arg-order-by"></a></dt>
<dd><p>Either a vector <code>z</code> or a formula with a single explanatory
    variable like <code>~ z</code>. The observations in the model
    are ordered by the size of <code>z</code>. If set to <code>NULL</code> (the
    default) the observations are assumed to be ordered (e.g., a
    time series).</p></dd>

 <dt id="arg-alternative">alternative<a class="anchor" aria-label="anchor" href="#arg-alternative"></a></dt>
<dd><p>a character string specifying the alternative hypothesis.</p></dd>

 <dt id="arg-iterations">iterations<a class="anchor" aria-label="anchor" href="#arg-iterations"></a></dt>
<dd><p>an integer specifying the number of iterations
    when calculating the p-value with the "pan" algorithm.</p></dd>

 <dt id="arg-exact">exact<a class="anchor" aria-label="anchor" href="#arg-exact"></a></dt>
<dd><p>logical. If set to <code>FALSE</code> a normal approximation
   will be used to compute the p value, if <code>TRUE</code> the "pan"
   algorithm is used. The default is to use "pan" if the sample size
   is &lt; 100.</p></dd>

 <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>tolerance. Eigenvalues computed have to be greater than
            <code>tol</code> to be treated as non-zero.</p></dd>

 <dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>an optional data frame containing the variables in the model.
    By default the variables are taken from the environment which <code>DurbinWatsonTest</code>
    is called from.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The Durbin-Watson test has the null hypothesis that the autocorrelation
of the disturbances is 0. It is possible to test against the alternative that it is
greater than, not equal to, or less than 0, respectively. This can be specified
by the <code>alternative</code> argument.</p>
<p>Under the assumption of normally distributed disturbances, the null distribution
of the Durbin-Watson statistic is the distribution of a linear
combination of chi-squared variables. The p-value is computed using the
Fortran version of Applied Statistics Algorithm AS 153 by Farebrother
(1980, 1984). This algorithm is called "pan" or "gradsol". For large sample
sizes the algorithm might fail to compute the p value; in that case a warning
is printed and an approximate p value will be given; this p value is computed
using a normal approximation with mean and variance of the Durbin-Watson test
statistic.</p>
<p>Examples can not only be found on this page, but also on the help pages of the
data sets <code>bondyield</code>, <code>currencysubstitution</code>,
<code>growthofmoney</code>, <code>moneydemand</code>,
<code>unemployment</code>, <code>wages</code>.</p>
<p>For an overview on R and econometrics see Racine &amp; Hyndman (2002).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"htest"</code> containing:</p>
<dl><dt>statistic</dt>
<dd><p>the test statistic.</p></dd>

  <dt>p.value</dt>
<dd><p>the corresponding p-value.</p></dd>

  <dt>method</dt>
<dd><p>a character string with the method used.</p></dd>

  <dt>data.name</dt>
<dd><p>a character string with the data name.</p></dd>

</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>This function was previously published as <code>dwtest</code> in the  <span class="pkg">lmtest</span> package and has been integrated here without logical changes.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Torsten Hothorn, Achim Zeileis, Richard W. Farebrother (pan.f), Clint Cummins (pan.f), Giovanni Millo, David Mitchell</p>
    </div>
    <div id="references">
    <h2>References</h2>


<p>J. Durbin &amp; G.S. Watson (1950),
Testing for Serial Correlation in Least Squares Regression I.
<em>Biometrika</em> <b>37</b>, 409–428.</p>
<p>J. Durbin &amp; G.S. Watson (1951),
Testing for Serial Correlation in Least Squares Regression II.
<em>Biometrika</em> <b>38</b>, 159–178.</p>
<p>J. Durbin &amp; G.S. Watson (1971),
Testing for Serial Correlation in Least Squares Regression III.
<em>Biometrika</em> <b>58</b>, 1–19.</p>
<p>R.W. Farebrother (1980),
Pan's Procedure for the Tail Probabilities of the
Durbin-Watson Statistic (Corr: 81V30 p189; AS R52: 84V33 p363- 366; AS
R53: 84V33 p366- 369).
<em>Applied Statistics</em> <b>29</b>,  224–227.</p>
<p>R. W. Farebrother (1984),
[AS R53] A Remark on Algorithms AS 106 (77V26 p92-98), AS 153 (80V29 p224-227)
  and AS 155: The Distribution of a Linear Combination of \(\chi^2\) Random
  Variables (80V29 p323-333)
<em>Applied Statistics</em> <b>33</b>, 366–369.</p>
<p>W. Krämer &amp; H. Sonnberger (1986),
<em>The Linear Regression Model under Test</em>. Heidelberg: Physica.</p>
<p>J. Racine &amp; R. Hyndman (2002),
Using R To Teach Econometrics.
<em>Journal of Applied Econometrics</em> <b>17</b>, 175–189.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate two AR(1) error terms with parameter</span></span></span>
<span class="r-in"><span><span class="co">## rho = 0 (white noise) and rho = 0.9 respectively</span></span></span>
<span class="r-in"><span><span class="va">err1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## generate regressor and dependent variable</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">err1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## perform Durbin-Watson test</span></span></span>
<span class="r-in"><span><span class="fu">DurbinWatsonTest</span><span class="op">(</span><span class="va">y1</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Durbin-Watson test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  y1 ~ x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DW = 2.1755, p-value = 0.8383</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true autocorrelation is greater than 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">err2</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">err1</span>, <span class="fl">0.9</span>, method<span class="op">=</span><span class="st">"recursive"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y2</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">x</span> <span class="op">+</span> <span class="va">err2</span></span></span>
<span class="r-in"><span><span class="fu">DurbinWatsonTest</span><span class="op">(</span><span class="va">y2</span> <span class="op">~</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Durbin-Watson test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  y2 ~ x</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DW = 0.35099, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true autocorrelation is greater than 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## for a simple vector use:</span></span></span>
<span class="r-in"><span><span class="va">e_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">32.33</span>, <span class="op">-</span><span class="fl">26.603</span>, <span class="fl">2.215</span>, <span class="op">-</span><span class="fl">16.967</span>, <span class="op">-</span><span class="fl">1.148</span>, <span class="op">-</span><span class="fl">2.512</span>, <span class="op">-</span><span class="fl">1.967</span>, <span class="fl">11.669</span>,</span></span>
<span class="r-in"><span>         <span class="op">-</span><span class="fl">0.513</span>, <span class="fl">27.032</span>, <span class="op">-</span><span class="fl">4.422</span>, <span class="fl">40.032</span>, <span class="fl">23.577</span>, <span class="fl">33.94</span>, <span class="op">-</span><span class="fl">2.787</span>, <span class="op">-</span><span class="fl">8.606</span>,</span></span>
<span class="r-in"><span>          <span class="fl">0.575</span>, <span class="fl">6.848</span>, <span class="op">-</span><span class="fl">18.971</span>, <span class="op">-</span><span class="fl">29.063</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">DurbinWatsonTest</span><span class="op">(</span><span class="va">e_t</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Durbin-Watson test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  e_t ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DW = 1.08, p-value = 0.01328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true autocorrelation is greater than 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

