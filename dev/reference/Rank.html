<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fast Sample Ranks — Rank • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Fast Sample Ranks — Rank" />
<meta property="og:description" content="The function base::rank has various weaknesses. Apart from the fact that it is not very fast, the option to calculate dense ranks is not implemented. Then, an argument for specifying the ranking direction is missing (assuming that this can be done with the ranking of the negative variables) and finally, multiple columns cannot be used in the case of ties for further ranking.
 The function data.table::frankv provides a more elaborated interface and convinces by very performant calculations and is much faster than the original. 
It further accepts vectors, lists, data.frames or data.tables as input. In addition to the ties.method possibilities provided by base::rank, it also provides ties.method=&quot;dense&quot;.  The present function Rank is merely a somewhat customized parameterization of the data.table function." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.40.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fast Sample Ranks</h1>
    
    <div class="hidden name"><code>Rank.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function <code><a href='https://rdrr.io/r/base/rank.html'>base::rank</a></code> has various weaknesses. Apart from the fact that it is not very fast, the option to calculate dense ranks is not implemented. Then, an argument for specifying the ranking direction is missing (assuming that this can be done with the ranking of the negative variables) and finally, multiple columns cannot be used in the case of ties for further ranking.
<br /> The function <code><a href='https://Rdatatable.gitlab.io/data.table/reference/frank.html'>data.table::frankv</a></code> provides a more elaborated interface and convinces by very performant calculations and is <em>much faster</em> than the original. 
It further accepts vectors, lists, <code>data.frame</code>s or <code>data.table</code>s as input. In addition to the <code>ties.method</code> possibilities provided by <code><a href='https://rdrr.io/r/base/rank.html'>base::rank</a></code>, it also provides <code>ties.method="dense"</code>. <br /> The present function <code>Rank</code> is merely a somewhat customized parameterization of the <code>data.table</code> function.</p>
    </div>

    <pre class="usage"><span class='fu'>Rank</span><span class='op'>(</span><span class='va'>...</span>, decreasing <span class='op'>=</span> <span class='cn'>FALSE</span>, na.last <span class='op'>=</span> <span class='cn'>TRUE</span>,
     ties.method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"average"</span>, <span class='st'>"first"</span>, <span class='st'>"last"</span>, <span class='st'>"random"</span>,
                     <span class='st'>"max"</span>, <span class='st'>"min"</span>, <span class='st'>"dense"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>...</th>
      <td><p>A vector, or list with all its elements identical in length or <code>data.frame</code> or <code>data.table</code>.</p></td>
    </tr>
    <tr>
      <th>decreasing</th>
      <td><p>An <code>logical</code> vector corresponding to ascending and descending order. <code>decreasing</code> is recycled to <code><a href='https://rdrr.io/r/base/length.html'>length(...)</a></code>.</p></td>
    </tr>
    <tr>
      <th>na.last</th>
      <td><p>Control treatment of <code>NA</code>s. If <code>TRUE</code>, missing values in the data are put last; if <code>FALSE</code>, they are put first; if <code>NA</code>, they are removed; if <code>"keep"</code> they are kept with rank <code>NA</code>.</p></td>
    </tr>
    <tr>
      <th>ties.method</th>
      <td><p>A character string specifying how ties are treated, see <code>Details</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To be consistent with other <code>data.table</code> operations, <code>NA</code>s are considered identical to other <code>NA</code>s (and <code>NaN</code>s to other <code>NaN</code>s), unlike <code><a href='https://rdrr.io/r/base/rank.html'>base::rank</a></code>. Therefore, for <code>na.last=TRUE</code> and <code>na.last=FALSE</code>, <code>NA</code>s (and <code>NaN</code>s) are given identical ranks, unlike <code><a href='https://rdrr.io/r/base/rank.html'>rank</a></code>.</p>
<p><code>Rank</code> is not limited to vectors. It accepts <code>data.table</code>s (and <code>list</code>s and <code>data.frame</code>s) as well. It accepts unquoted column names (with names preceded with a <code><a href='https://rdrr.io/r/base/Arithmetic.html'>-</a></code> sign for descending order, even on character vectors), for e.g., <code>Rank(DT, a, -b, c, ties.method="first")</code> where <code>a,b,c</code> are columns in <code>DT</code>.</p>
<p>In addition to the <code>ties.method</code> values possible using base's <code><a href='https://rdrr.io/r/base/rank.html'>rank</a></code>, it also provides another additional argument <code>"dense"</code> which returns the ranks without any gaps in the ranking. See examples.</p>
<p>Like <code>forder</code>, sorting is done in "C-locale"; in particular, this may affect how capital/lowercase letters are ranked. See Details on <code>forder</code> for more.</p>
<p><code>bit64::integer64</code> type is also supported.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A numeric vector of length equal to <code><a href='https://rdrr.io/r/base/nrow.html'>NROW(x)</a></code> (unless <code>na.last = NA</code>, when missing values are removed). The vector is of integer type unless <code>ties.method = "average"</code> when it is of double type (irrespective of ties).</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code>frankv</code>, <code>data.table</code>, <code>setkey</code>, <code>setorder</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># on vectors</span>
<span class='va'>x</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>1</span>, <span class='fl'>4</span>, <span class='cn'>NA</span>, <span class='fl'>1</span>, <span class='cn'>NA</span>, <span class='fl'>4</span><span class='op'>)</span>
<span class='co'># NAs are considered identical (unlike base R)</span>
<span class='co'># default is average</span>
<span class='fu'>Rank</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='co'># na.last=TRUE</span>
</div><div class='output co'>#&gt; [1] 4.0 1.5 4.0 6.5 1.5 6.5 4.0</div><div class='input'><span class='fu'>Rank</span><span class='op'>(</span><span class='va'>x</span>, na.last<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 6.0 3.5 6.0 1.5 3.5 1.5 6.0</div><div class='input'>
<span class='co'># ties.method = min</span>
<span class='fu'>Rank</span><span class='op'>(</span><span class='va'>x</span>, ties.method<span class='op'>=</span><span class='st'>"min"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 3 1 3 6 1 6 3</div><div class='input'><span class='co'># ties.method = dense</span>
<span class='fu'>Rank</span><span class='op'>(</span><span class='va'>x</span>, ties.method<span class='op'>=</span><span class='st'>"dense"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2 1 2 3 1 3 2</div><div class='input'>
<span class='co'># on data.frame, using both columns</span>
<span class='va'>d.set</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='va'>x</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>1</span>, <span class='fl'>0</span>, <span class='cn'>NA</span>, <span class='fl'>0</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>Rank</span><span class='op'>(</span><span class='va'>d.set</span>, na.last<span class='op'>=</span><span class='st'>"keep"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2.5 1.0 2.5  NA  NA  NA 4.0</div><div class='input'><span class='fu'>Rank</span><span class='op'>(</span><span class='va'>d.set</span>, ties.method<span class='op'>=</span><span class='st'>"dense"</span>, na.last<span class='op'>=</span><span class='cn'>NA</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 2 1 2 3</div><div class='input'>
<span class='co'># decreasing argument</span>
<span class='fu'>Rank</span><span class='op'>(</span><span class='va'>d.set</span>, decreasing<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='cn'>FALSE</span>, <span class='cn'>TRUE</span><span class='op'>)</span>, ties.method<span class='op'>=</span><span class='st'>"first"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 4 1 5 6 2 7 3</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


