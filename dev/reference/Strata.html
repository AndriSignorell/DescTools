<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stratified Sampling — Strata • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Stratified Sampling — Strata" />
<meta property="og:description" content="Stratified sampling with equal/unequal probabilities." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.40.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified Sampling</h1>
    
    <div class="hidden name"><code>Strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stratified sampling with equal/unequal probabilities.</p>
    </div>

    <pre class="usage"><span class='fu'>Strata</span><span class='op'>(</span><span class='va'>x</span>, stratanames <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>size</span>,
       method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"srswor"</span>, <span class='st'>"srswr"</span>, <span class='st'>"poisson"</span>, <span class='st'>"systematic"</span><span class='op'>)</span>,
       <span class='va'>pik</span>, description <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data frame or a matrix; its number of rows is n, the population size.</p></td>
    </tr>
    <tr>
      <th>stratanames</th>
      <td><p>vector of stratification variables.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>vector of stratum sample sizes (in the order in which the strata are given in the input
data set).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method to select units; implemented are: a) simple random
sampling without replacement (<code>"srswor"</code>), b) simple random sampling with replacement (<code>"srswr"</code>),
c) Poisson sampling (<code>"poisson"</code>), d) systematic sampling (<code>"systematic"</code>) (default is <code>"srswor"</code>).</p></td>
    </tr>
    <tr>
      <th>pik</th>
      <td><p>vector of inclusion probabilities or auxiliary information used to compute them;
this argument is only used for unequal probability sampling (Poisson and systematic). If an
auxiliary information is provided, the function uses the inclusionprobabilities function for
computing these probabilities. If the method is "srswr" and the sample size is larger than
the population size, this vector is normalized to one.</p></td>
    </tr>
    <tr>
      <th>description</th>
      <td><p>a message is printed if its value is TRUE; the message gives the number
of selected units and the number of the units in the population.
By default, the value is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function produces an object, which contains the following information:</p>
<dt>id</dt><dd><p>the identifier of the selected units.</p></dd>
<dt>stratum</dt><dd><p>the unit stratum.</p></dd>
<dt>prob</dt><dd><p>the final unit inclusion probability.</p></dd>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Andri Signorell &lt;andri@signorell.net&gt;
<br /> rewritten based on the ideas of Yves Tille &lt;yves.tille@unine.ch&gt; and Alina Matei &lt;alina.matei@unine.ch&gt;</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/sample.html'>sample</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example from An and Watts (New SAS procedures for Analysis of Sample Survey Data)</span>
<span class='co'># generates artificial data (a 235X3 matrix with 3 columns: state, region, income).</span>
<span class='co'># the variable "state" has 2 categories ('nc' and 'sc').</span>
<span class='co'># the variable "region" has 3 categories (1, 2 and 3).</span>
<span class='co'># the sampling frame is stratified by region within state.</span>
<span class='co'># the income variable is randomly generated</span>

<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"nc"</span>,<span class='fl'>165</span><span class='op'>)</span>, <span class='fl'>165</span>, <span class='fl'>1</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>,
           <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='st'>"sc"</span>, <span class='fl'>70</span><span class='op'>)</span>, <span class='fl'>70</span>, <span class='fl'>1</span>, byrow<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>m</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind.data.frame</a></span><span class='op'>(</span><span class='va'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>100</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>50</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>3</span>,<span class='fl'>15</span><span class='op'>)</span>,
                      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>30</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>40</span><span class='op'>)</span><span class='op'>)</span>, <span class='fl'>1000</span> <span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span><span class='op'>(</span><span class='fl'>235</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"state"</span>, <span class='st'>"region"</span>, <span class='st'>"income"</span><span class='op'>)</span>

<span class='co'># computes the population stratum sizes</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>m</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>m</span><span class='op'>$</span><span class='va'>state</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    
#&gt;      nc  sc
#&gt;   1 100  30
#&gt;   2  50  40
#&gt;   3  15   0</div><div class='input'>
<span class='co'># not run</span>
<span class='co'>#     nc  sc</span>
<span class='co'>#  1 100  30</span>
<span class='co'>#  2  50  40</span>
<span class='co'>#  3  15   0</span>
<span class='co'># there are 5 cells with non-zero values</span>
<span class='co'># one draws 5 samples (1 sample in each stratum)</span>
<span class='co'># the sample stratum sizes are 10,5,10,4,6, respectively</span>
<span class='co'># the method is 'srswor' (equal probability, without replacement)</span>

<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'>Strata</span><span class='op'>(</span><span class='va'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"region"</span>, <span class='st'>"state"</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span><span class='op'>)</span>, method<span class='op'>=</span><span class='st'>"srswor"</span><span class='op'>)</span>

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>income<span class='op'>=</span><span class='va'>m</span><span class='op'>[</span><span class='va'>s</span><span class='op'>$</span><span class='va'>id</span>, <span class='st'>"income"</span><span class='op'>]</span>, <span class='va'>s</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.65  866.10058    nc      1 866.10058       1   10  65
#&gt; 1.93  592.34629    nc      1 592.34629       1   10  93
#&gt; 1.29  286.04175    nc      1 286.04175       1   10  29
#&gt; 1.64  547.19689    nc      1 547.19689       1   10  64
#&gt; 1.34  200.38347    nc      1 200.38347       1   10  34
#&gt; 1.45  482.35179    nc      1 482.35179       1   10  45
#&gt; 1.26   52.49346    nc      1  52.49346       1   10  26
#&gt; 1.8   598.38073    nc      1 598.38073       1   10   8
#&gt; 1.52  329.42273    nc      1 329.42273       1   10  52
#&gt; 1.62  895.92032    nc      1 895.92032       1   10  62
#&gt; 2.120 507.15857    nc      2 507.15857       2    5 120
#&gt; 2.143 232.86548    nc      2 232.86548       2    5 143
#&gt; 2.147 688.35110    nc      2 688.35110       2    5 147
#&gt; 2.109 451.99868    nc      2 451.99868       2    5 109
#&gt; 2.130 571.54761    nc      2 571.54761       2    5 130
#&gt; 3.165 794.92344    nc      3 794.92344       3   10 165
#&gt; 3.151 628.19458    nc      3 628.19458       3   10 151
#&gt; 3.156 755.49937    nc      3 755.49937       3   10 156
#&gt; 3.160 426.00580    nc      3 426.00580       3   10 160
#&gt; 3.157 578.61374    nc      3 578.61374       3   10 157
#&gt; 3.164 616.97988    nc      3 616.97988       3   10 164
#&gt; 3.152 780.21599    nc      3 780.21599       3   10 152
#&gt; 3.162 507.13136    nc      3 507.13136       3   10 162
#&gt; 3.153 178.19258    nc      3 178.19258       3   10 153
#&gt; 3.159 948.04473    nc      3 948.04473       3   10 159
#&gt; 4.167 427.83172    sc      1 427.83172       4    4 167
#&gt; 4.181 381.52305    sc      1 381.52305       4    4 181
#&gt; 4.170 391.48706    sc      1 391.48706       4    4 170
#&gt; 4.169  27.68708    sc      1  27.68708       4    4 169
#&gt; 5.202 773.62990    sc      2 773.62990       5    6 202
#&gt; 5.231 469.94421    sc      2 469.94421       5    6 231
#&gt; 5.233 196.68003    sc      2 196.68003       5    6 233
#&gt; 5.217 822.34924    sc      2 822.34924       5    6 217
#&gt; 5.229 369.66882    sc      2 369.66882       5    6 229
#&gt; 5.208 152.05055    sc      2 152.05055       5    6 208</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>state</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div><div class='input'>

<span class='co'># The same data as in Example 1</span>
<span class='co'># the method is 'systematic' (unequal probability, without replacement)</span>
<span class='co'># the selection probabilities are computed using the variable 'income'</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='fu'>Strata</span><span class='op'>(</span><span class='va'>m</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"region"</span>, <span class='st'>"state"</span><span class='op'>)</span>, size<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span><span class='op'>)</span>,
            method<span class='op'>=</span><span class='st'>"systematic"</span>, pik<span class='op'>=</span><span class='va'>m</span><span class='op'>$</span><span class='va'>income</span><span class='op'>)</span>

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span>income<span class='op'>=</span><span class='va'>m</span><span class='op'>[</span><span class='va'>s</span><span class='op'>$</span><span class='va'>id</span>, <span class='st'>"income"</span><span class='op'>]</span>, <span class='va'>s</span><span class='op'>)</span>
</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.9   322.88584    nc      1 322.88584       1   10   9
#&gt; 1.29  286.04175    nc      1 286.04175       1   10  29
#&gt; 1.86  636.40332    nc      1 636.40332       1   10  86
#&gt; 1.16  104.97314    nc      1 104.97314       1   10  16
#&gt; 1.8   598.38073    nc      1 598.38073       1   10   8
#&gt; 1.36  793.01949    nc      1 793.01949       1   10  36
#&gt; 1.92  448.64375    nc      1 448.64375       1   10  92
#&gt; 1.100 380.39065    nc      1 380.39065       1   10 100
#&gt; 1.66  655.96816    nc      1 655.96816       1   10  66
#&gt; 1.18  408.09932    nc      1 408.09932       1   10  18
#&gt; 2.145 737.76557    nc      2 737.76557       2    5 145
#&gt; 2.135  80.87036    nc      2  80.87036       2    5 135
#&gt; 2.112 919.35027    nc      2 919.35027       2    5 112
#&gt; 2.150 749.40846    nc      2 749.40846       2    5 150
#&gt; 2.103 552.14334    nc      2 552.14334       2    5 103
#&gt; 3.157 578.61374    nc      3 578.61374       3   10 157
#&gt; 3.160 426.00580    nc      3 426.00580       3   10 160
#&gt; 3.152 780.21599    nc      3 780.21599       3   10 152
#&gt; 3.156 755.49937    nc      3 755.49937       3   10 156
#&gt; 3.158 177.50997    nc      3 177.50997       3   10 158
#&gt; 3.164 616.97988    nc      3 616.97988       3   10 164
#&gt; 3.151 628.19458    nc      3 628.19458       3   10 151
#&gt; 3.163 385.42599    nc      3 385.42599       3   10 163
#&gt; 3.153 178.19258    nc      3 178.19258       3   10 153
#&gt; 3.154 712.35448    nc      3 712.35448       3   10 154
#&gt; 4.183 195.25163    sc      1 195.25163       4    4 183
#&gt; 4.170 391.48706    sc      1 391.48706       4    4 170
#&gt; 4.186 131.10277    sc      1 131.10277       4    4 186
#&gt; 4.184 982.18831    sc      1 982.18831       4    4 184
#&gt; 5.200 388.30586    sc      2 388.30586       5    6 200
#&gt; 5.214 677.27586    sc      2 677.27586       5    6 214
#&gt; 5.229 369.66882    sc      2 369.66882       5    6 229
#&gt; 5.198 483.59321    sc      2 483.59321       5    6 198
#&gt; 5.224 771.66254    sc      2 771.66254       5    6 224
#&gt; 5.205 192.33168    sc      2 192.33168       5    6 205</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>region</span>, <span class='va'>s</span><span class='op'>$</span><span class='va'>state</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


