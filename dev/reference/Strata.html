<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Stratified Sampling — Strata • DescTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Stratified Sampling — Strata"><meta property="og:description" content="Stratified sampling with equal/unequal probabilities."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.60.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>


    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf" class="external-link">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf" class="external-link">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf" class="external-link">Combinatorics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AndriSignorell/DescTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified Sampling</h1>

    <div class="hidden name"><code>Strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stratified sampling with equal/unequal probabilities.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Strata</span><span class="op">(</span><span class="va">x</span>, stratanames <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">size</span>,</span>
<span>       method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"srswor"</span>, <span class="st">"srswr"</span>, <span class="st">"poisson"</span>, <span class="st">"systematic"</span><span class="op">)</span>,</span>
<span>       <span class="va">pik</span>, description <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a data frame or a matrix; its number of rows is n, the population size.</p></dd>


<dt id="arg-stratanames">stratanames<a class="anchor" aria-label="anchor" href="#arg-stratanames"></a></dt>
<dd><p>vector of stratification variables.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>vector of stratum sample sizes (in the order in which the strata are given in the input
data set).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>method to select units; implemented are: a) simple random
sampling without replacement (<code>"srswor"</code>), b) simple random sampling with replacement (<code>"srswr"</code>),
c) Poisson sampling (<code>"poisson"</code>), d) systematic sampling (<code>"systematic"</code>) (default is <code>"srswor"</code>).</p></dd>


<dt id="arg-pik">pik<a class="anchor" aria-label="anchor" href="#arg-pik"></a></dt>
<dd><p>vector of inclusion probabilities or auxiliary information used to compute them;
this argument is only used for unequal probability sampling (Poisson and systematic). If an
auxiliary information is provided, the function uses the inclusionprobabilities function for
computing these probabilities. If the method is "srswr" and the sample size is larger than
the population size, this vector is normalized to one.</p></dd>


<dt id="arg-description">description<a class="anchor" aria-label="anchor" href="#arg-description"></a></dt>
<dd><p>a message is printed if its value is TRUE; the message gives the number
of selected units and the number of the units in the population.
By default, the value is FALSE.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function produces an object, which contains the following information:</p>
<dl><dt>id</dt>
<dd><p>the identifier of the selected units.</p></dd>

<dt>stratum</dt>
<dd><p>the unit stratum.</p></dd>

<dt>prob</dt>
<dd><p>the final unit inclusion probability.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Andri Signorell &lt;andri@signorell.net&gt;
<br> rewritten based on the ideas of Yves Tille &lt;yves.tille@unine.ch&gt; and Alina Matei &lt;alina.matei@unine.ch&gt;</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example from An and Watts (New SAS procedures for Analysis of Sample Survey Data)</span></span></span>
<span class="r-in"><span><span class="co"># generates artificial data (a 235X3 matrix with 3 columns: state, region, income).</span></span></span>
<span class="r-in"><span><span class="co"># the variable "state" has 2 categories ('nc' and 'sc').</span></span></span>
<span class="r-in"><span><span class="co"># the variable "region" has 3 categories (1, 2 and 3).</span></span></span>
<span class="r-in"><span><span class="co"># the sampling frame is stratified by region within state.</span></span></span>
<span class="r-in"><span><span class="co"># the income variable is randomly generated</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"nc"</span>,<span class="fl">165</span><span class="op">)</span>, <span class="fl">165</span>, <span class="fl">1</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>           <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"sc"</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fl">70</span>, <span class="fl">1</span>, byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">100</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                      <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">30</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1000</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">235</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"region"</span>, <span class="st">"income"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># computes the population stratum sizes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">m</span><span class="op">$</span><span class="va">region</span>, <span class="va">m</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      nc  sc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 100  30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2  50  40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3  15   0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># not run</span></span></span>
<span class="r-in"><span><span class="co">#     nc  sc</span></span></span>
<span class="r-in"><span><span class="co">#  1 100  30</span></span></span>
<span class="r-in"><span><span class="co">#  2  50  40</span></span></span>
<span class="r-in"><span><span class="co">#  3  15   0</span></span></span>
<span class="r-in"><span><span class="co"># there are 5 cells with non-zero values</span></span></span>
<span class="r-in"><span><span class="co"># one draws 5 samples (1 sample in each stratum)</span></span></span>
<span class="r-in"><span><span class="co"># the sample stratum sizes are 10,5,10,4,6, respectively</span></span></span>
<span class="r-in"><span><span class="co"># the method is 'srswor' (equal probability, without replacement)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">Strata</span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"region"</span>, <span class="st">"state"</span><span class="op">)</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"srswor"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extracts the observed data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>income<span class="op">=</span><span class="va">m</span><span class="op">[</span><span class="va">s</span><span class="op">$</span><span class="va">id</span>, <span class="st">"income"</span><span class="op">]</span>, <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          income state region  income.1 stratum size  id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.1   431.79468    nc      1 431.79468       1   10   1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.80  256.99471    nc      1 256.99471       1   10  80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.73   27.68708    nc      1  27.68708       1   10  73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.32  785.78417    nc      1 785.78417       1   10  32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.15  982.44097    nc      1 982.44097       1   10  15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.71  427.83172    nc      1 427.83172       1   10  71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.66  507.13136    nc      1 507.13136       1   10  66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.81  249.62570    nc      1 249.62570       1   10  81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.13  451.99868    nc      1 451.99868       1   10  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.57  178.19258    nc      1 178.19258       1   10  57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.130 460.58674    nc      2 460.58674       2    5 130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.135 469.94421    nc      2 469.94421       2    5 135</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.117 991.83105    nc      2 991.83105       2    5 117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.106 773.62990    nc      2 773.62990       2    5 106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.109 192.33168    nc      2 192.33168       2    5 109</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.160 512.05001    nc      3 512.05001       3   10 160</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.163 708.51129    nc      3 708.51129       3   10 163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.161 771.14369    nc      3 771.14369       3   10 161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.154 853.65094    nc      3 853.65094       3   10 154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.157 411.88021    nc      3 411.88021       3   10 157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.152 390.29183    nc      3 390.29183       3   10 152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.158 636.70828    nc      3 636.70828       3   10 158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.151 663.38892    nc      3 663.38892       3   10 151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.164 999.05023    nc      3 999.05023       3   10 164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.156 533.18085    nc      3 533.18085       3   10 156</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.180 464.97943    sc      1 464.97943       4    4 180</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.175 520.83494    sc      1 520.83494       4    4 175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.174 569.91573    sc      1 569.91573       4    4 174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.186  35.69785    sc      1  35.69785       4    4 186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.204 151.80241    sc      2 151.80241       5    6 204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.198 424.94331    sc      2 424.94331       5    6 198</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.216 516.31473    sc      2 516.31473       5    6 216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.222 833.44388    sc      2 833.44388       5    6 222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.201  16.52919    sc      2  16.52919       5    6 201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.228 307.86605    sc      2 307.86605       5    6 228</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see the result using a contigency table</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">region</span>, <span class="va">s</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nc sc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 10  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2  5  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3 10  0</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The same data as in Example 1</span></span></span>
<span class="r-in"><span><span class="co"># the method is 'systematic' (unequal probability, without replacement)</span></span></span>
<span class="r-in"><span><span class="co"># the selection probabilities are computed using the variable 'income'</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">Strata</span><span class="op">(</span><span class="va">m</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"region"</span>, <span class="st">"state"</span><span class="op">)</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            method<span class="op">=</span><span class="st">"systematic"</span>, pik<span class="op">=</span><span class="va">m</span><span class="op">$</span><span class="va">income</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extracts the observed data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>income<span class="op">=</span><span class="va">m</span><span class="op">[</span><span class="va">s</span><span class="op">$</span><span class="va">id</span>, <span class="st">"income"</span><span class="op">]</span>, <span class="va">s</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          income state region  income.1 stratum size  id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.13  451.99868    nc      1 451.99868       1   10  13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.27   20.54442    nc      1  20.54442       1   10  27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.7   552.14334    nc      1 552.14334       1   10   7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.48  934.30059    nc      1 934.30059       1   10  48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.62  177.50997    nc      1 177.50997       1   10  62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.50  887.68151    nc      1 887.68151       1   10  50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.66  507.13136    nc      1 507.13136       1   10  66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.80  256.99471    nc      1 256.99471       1   10  80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.97  270.36405    nc      1 270.36405       1   10  97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.100 888.16006    nc      1 888.16006       1   10 100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.134 894.79894    nc      2 894.79894       2    5 134</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.145 486.84010    nc      2 486.84010       2    5 145</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.142 601.15380    nc      2 601.15380       2    5 142</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.117 991.83105    nc      2 991.83105       2    5 117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.107  36.20353    nc      2  36.20353       2    5 107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.154 853.65094    nc      3 853.65094       3   10 154</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.165 135.38640    nc      3 135.38640       3   10 165</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.163 708.51129    nc      3 708.51129       3   10 163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.158 636.70828    nc      3 636.70828       3   10 158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.159 914.26539    nc      3 914.26539       3   10 159</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.151 663.38892    nc      3 663.38892       3   10 151</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.162 383.89029    nc      3 383.89029       3   10 162</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.161 771.14369    nc      3 771.14369       3   10 161</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.153 876.68424    nc      3 876.68424       3   10 153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3.152 390.29183    nc      3 390.29183       3   10 152</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.191 285.42066    sc      1 285.42066       4    4 191</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.167  58.01234    sc      1  58.01234       4    4 167</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.168 141.61709    sc      1 141.61709       4    4 168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4.181  27.77380    sc      1  27.77380       4    4 181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.209 338.79154    sc      2 338.79154       5    6 209</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.223 947.00049    sc      2 947.00049       5    6 223</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.221 852.56993    sc      2 852.56993       5    6 221</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.213 632.28781    sc      2 632.28781       5    6 213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.230 556.82973    sc      2 556.82973       5    6 230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5.217 106.51764    sc      2 106.51764       5    6 217</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># see the result using a contigency table</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">region</span>, <span class="va">s</span><span class="op">$</span><span class="va">state</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     nc sc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1 10  4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2  5  6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3 10  0</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

