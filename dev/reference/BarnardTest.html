<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Barnard's Unconditional Test — BarnardTest • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Barnard's Unconditional Test — BarnardTest" />
<meta property="og:description" content="Barnard's unconditional test for superiority applied to \(2 \times 2\) contingency tables
using Score or Wald statistics for the difference between two binomial proportions." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.40.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Barnard's Unconditional Test</h1>
    
    <div class="hidden name"><code>BarnardTest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Barnard's unconditional test for superiority applied to \(2 \times 2\) contingency tables
using Score or Wald statistics for the difference between two binomial proportions.</p>
    </div>

    <pre class="usage"><span class='fu'>BarnardTest</span><span class='op'>(</span><span class='va'>x</span>, y <span class='op'>=</span> <span class='cn'>NULL</span>, alternative <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>, <span class='st'>"less"</span>, <span class='st'>"greater"</span><span class='op'>)</span>,
            method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"csm"</span>, <span class='st'>"csm approximate"</span>, <span class='st'>"z-pooled"</span>, <span class='st'>"z-unpooled"</span>,
                       <span class='st'>"boschloo"</span>, <span class='st'>"santner and snell"</span><span class='op'>)</span>, fixed <span class='op'>=</span> <span class='fl'>1</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a numeric vector or a two-dimensional contingency table in matrix form. <code>x</code> and <code>y</code> can also both be factors.</p></td>
    </tr>
    <tr>
      <th>y</th>
      <td><p>a factor object; ignored if <code>x</code> is a matrix.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>a character string specifying the alternative
    hypothesis, must be one of <code>"two.sided"</code> (default),
    <code>"greater"</code> or <code>"less"</code>.  You can specify just the initial
    letter.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Indicates the method for finding the more extreme tables: must be either <code>"Zpooled"</code>, <code>"Z-unpooled"</code>, <code>"Santner and Snell"</code>, <code>"Boschloo"</code>, <code>"CSM"</code>, or <code>"CSM approximate"</code>. CSM tests cannot be calculated for multinomial models.</p></td>
    </tr>
    <tr>
      <th>fixed</th>
      <td><p>indicates which margins are fixed. <code>1</code> stands for row, <code>2</code> for columns, <code>NA</code> for none of both.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>the dots are passed on to the <code><a href='https://rdrr.io/pkg/Exact/man/exact.test.html'>Exact::exact.test()</a></code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with class <code>"htest"</code> containing the following components:</p>
<dt>p.value</dt><dd><p>the p-value of the test.</p></dd>
   <dt>estimate</dt><dd><p>an estimate of the nuisance parameter where the p-value is maximized.</p></dd>
   <dt>alternative</dt><dd><p>a character string describing the alternative
     hypothesis.</p></dd>
   <dt>method</dt><dd><p>the character string
     <code>"Barnards Unconditional 2x2-test"</code>.</p></dd>
   <dt>data.name</dt><dd><p>a character string giving the names of the data.</p></dd>
  <dt>statistic.table </dt><dd><p>The contingency tables considered in the analysis represented by <code>n1</code> and <code>n2</code>, their scores, and whether they are included in the one-sided (<code>1</code>), two-sided (<code>2</code>) tests, or not included at all (<code>0</code>)</p></dd>
   <dt>nuisance.matrix </dt><dd><p>Nuisance parameters, <code>p</code>, and the corresponding p-values for both one- and two-sided tests</p></dd>

 
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>There are two fundamentally different exact tests for comparing the equality of two binomial probabilities - Fisher's exact test (Fisher, 1925), and Barnard's exact test (Barnard, 1945). Fisher's exact test (Fisher, 1925) is the more popular of the two. In fact, Fisher was bitterly critical of Barnard's proposal for esoteric reasons that we will not go into here. For 2 x 2 tables, Barnard's test is more powerful than Fisher's, as Barnard noted in his 1945 paper, much to Fisher's chagrin. Anyway, perhaps due to its computational difficulty the Barnard's is not widely used. (Mehta et.al., 2003)</p>
<p>Unconditional exact tests can be performed for binomial or multinomial models. The binomial model assumes the row or column margins (but not both) are known in advance, while the multinomial model assumes only the total sample size is known beforehand. 
For the binomial model, the user needs to specify which margin is fixed (default is rows). Conditional tests (e.g., Fisher's exact test) have both row and column margins fixed, but this is a very uncommon design. (See Calhoun (2019) for more details.)</p>
<p>If <code>x</code> is a matrix, it is taken as a two-dimensional contingency
   table, and hence its entries should be nonnegative integers.
   Otherwise, both <code>x</code> and <code>y</code> must be vectors of the same
   length.  Incomplete cases are removed, the vectors are coerced into
   factor objects, and the contingency table is computed from these.</p>
<p>For a 2x2 contingency table, such as \(X=[n_1,n_2;n_3,n_4]\), the normalized difference in proportions between the two categories, given in each column, can be written with pooled variance (Score statistic) as
$$T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\hat{p}(1-\hat{p})(\frac{1}{c_1}+\frac{1}{c_2})}},$$
where \(\hat{p}=(n_1+n_3)/(n_1+n_2+n_3+n_4)\), \(\hat{p}_2=n_2/(n_2+n_4)\), \(\hat{p}_1=n_1/(n_1+n_3)\), \(c_1=n_1+n_3\) and \(c_2=n_2+n_4\). Alternatively, with unpooled variance (Wald statistic), the difference in proportions can we written as
$$T(X)=\frac{\hat{p}_2-\hat{p}_1}{\sqrt{\frac{\hat{p}_1(1-\hat{p}_1)}{c_1}+\frac{\hat{p}_2(1-\hat{p}_2)}{c_2}}}.$$
The probability of observing \(X\) is
$$P(X)=\frac{c_1!c_2!}{n_1!n_2!n_3!n_4!}p^{n_1+n_2}(1-p)^{n_3+n_4},$$
where \(p\) is the unknown nuisance parameter.</p>
<p>Barnard's test considers all tables with category sizes \(c_1\) and \(c_2\) for a given \(p\). The p-value is the sum of probabilities of the tables having a score in the rejection region, e.g. having significantly large difference in proportions for a two-sided test. The p-value of the test is the maximum p-value calculated over all \(p\) between 0 and 1.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Barnard, G.A. (1945) A new test for 2x2 tables. <em>Nature</em>, 156:177.</p>
<p>Barnard, G.A. (1947) Significance tests for 2x2 tables. <em>Biometrika</em>, 34:123-138.</p>
<p>Suissa, S. and Shuster, J. J. (1985), Exact Unconditional Sample Sizes for the 2x2 Binomial Trial, <em>Journal of the Royal Statistical Society</em>, Ser. A, 148, 317-327.</p>
<p>Cardillo G. (2009) MyBarnard: a very compact routine for Barnard's exact test on 2x2 matrix. <a href='https://ch.mathworks.com/matlabcentral/fileexchange/25760-mybarnard'>https://ch.mathworks.com/matlabcentral/fileexchange/25760-mybarnard</a></p>
<p>Galili T. (2010) <a href='https://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/'>https://www.r-statistics.com/2010/02/barnards-exact-test-a-powerful-alternative-for-fishers-exact-test-implemented-in-r/</a></p>
<p>Lin C.Y., Yang M.C. (2009) Improved p-value tests for comparing two independent binomial proportions. <em>Communications in Statistics-Simulation and Computation</em>, 38(1):78-91.</p>
<p>Trujillo-Ortiz, A., R. Hernandez-Walls, A. Castro-Perez, L. Rodriguez-Cardozo N.A. Ramos-Delgado and R. Garcia-Sanchez. (2004). Barnardextest:Barnard's Exact Probability Test. A MATLAB file. [WWW document]. <a href='https://www.mathworks.com/'>https://www.mathworks.com/</a></p>
<p>Mehta, C.R., Senchaudhuri, P. (2003) Conditional versus unconditional exact tests for comparing two binomials. <a href='https://www.researchgate.net/publication/242179503_Conditional_versus_Unconditional_Exact_Tests_for_Comparing_Two_Binomials'>https://www.researchgate.net/publication/242179503_Conditional_versus_Unconditional_Exact_Tests_for_Comparing_Two_Binomials</a></p>
<p>Calhoun, P. (2019) Exact: Unconditional Exact Test. R package version
  2.0. <br /> <a href='https://CRAN.R-project.org/package=Exact'>https://CRAN.R-project.org/package=Exact</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Peter Calhoun &lt;calhoun.peter@gmail.com&gt;, Andri Signorell &lt;andri@signorell.net&gt; (interface)</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/stats/fisher.test.html'>fisher.test</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>as.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>8</span>, <span class='fl'>14</span>, <span class='fl'>1</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>2</span>,
                dimnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>treat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I"</span>,<span class='st'>"II"</span><span class='op'>)</span>, out<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I"</span>,<span class='st'>"II"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>BarnardTest</span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	CSM Exact Test
#&gt; 
#&gt; data:  8 out of 9 vs. 14 out of 17
#&gt; test statistic = NA, first sample size = 9, second sample size = 17,
#&gt; p-value = 0.7181
#&gt; alternative hypothesis: true difference in proportion is not equal to 0
#&gt; sample estimates:
#&gt; difference in proportion 
#&gt;               0.06535948 
#&gt; </div><div class='input'>
<span class='co'># Plotting the search for the nuisance parameter for a one-sided test</span>
<span class='va'>bt</span> <span class='op'>&lt;-</span> <span class='fu'>BarnardTest</span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span>

<span class='co'># Plotting the tables included in the p-value</span>
<span class='va'>ttab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>as.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>40</span>, <span class='fl'>14</span>, <span class='fl'>10</span>, <span class='fl'>30</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>2</span>,
                 dimnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>treat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I"</span>,<span class='st'>"II"</span><span class='op'>)</span>, out<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"I"</span>,<span class='st'>"II"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>bt</span> <span class='op'>&lt;-</span> <span class='fu'>BarnardTest</span><span class='op'>(</span><span class='va'>ttab</span><span class='op'>)</span>
<span class='va'>bts</span> <span class='op'>&lt;-</span> <span class='va'>bt</span><span class='op'>$</span><span class='va'>statistic.table</span>

<span class='co'># Mehta et. al (2003)</span>
<span class='va'>tab</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>as.table</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>7</span>, <span class='fl'>12</span>, <span class='fl'>8</span>, <span class='fl'>3</span><span class='op'>)</span>, nrow<span class='op'>=</span><span class='fl'>2</span>,
                       dimnames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>treat<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"vaccine"</span>,<span class='st'>"placebo"</span><span class='op'>)</span>,
                                     infection<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"yes"</span>,<span class='st'>"no"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>BarnardTest</span><span class='op'>(</span><span class='va'>tab</span>, alternative<span class='op'>=</span><span class='st'>"less"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 
#&gt; 	CSM Exact Test
#&gt; 
#&gt; data:  7 out of 15 vs. 12 out of 15
#&gt; test statistic = NA, first sample size = 15, second sample size = 15,
#&gt; p-value = 0.03669
#&gt; alternative hypothesis: true difference in proportion is less than 0
#&gt; sample estimates:
#&gt; difference in proportion 
#&gt;               -0.3333333 
#&gt; </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


