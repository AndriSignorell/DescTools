<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Covariance and Correlation (Matrices) — Cor • DescTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Covariance and Correlation (Matrices) — Cor"><meta property="og:description" content="Cov and Cor compute the covariance or correlation of x and y if these
  are vectors.   If x and y are matrices then the
  covariances (or correlations) between the columns of x and the
  columns of y are computed."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.47.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf" class="external-link">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf" class="external-link">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf" class="external-link">Combinatorics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AndriSignorell/DescTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Covariance and Correlation (Matrices)</h1>
    
    <div class="hidden name"><code>Cor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>Cov</code> and <code>Cor</code> compute the covariance or correlation of <code>x</code> and <code>y</code> if these
  are vectors.   If <code>x</code> and <code>y</code> are matrices then the
  covariances (or correlations) between the columns of <code>x</code> and the
  columns of <code>y</code> are computed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Cov</span><span class="op">(</span><span class="va">x</span>, y <span class="op">=</span> <span class="cn">NULL</span>, use <span class="op">=</span> <span class="st">"everything"</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"kendall"</span>, <span class="st">"spearman"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Cor</span><span class="op">(</span><span class="va">x</span>, y <span class="op">=</span> <span class="cn">NULL</span>, use <span class="op">=</span> <span class="st">"everything"</span>,</span>
<span>    method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pearson"</span>, <span class="st">"kendall"</span>, <span class="st">"spearman"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a numeric vector, matrix or data frame.</p></dd>

  <dt>y</dt>
<dd><p><code>NULL</code> (default) or a vector, matrix or data frame with
    compatible dimensions to <code>x</code>.   The default is equivalent to
    <code>y = x</code> (but more efficient).</p></dd>


  <dt>use</dt>
<dd><p>an optional character string giving a
    method for computing covariances in the presence
    of missing values.  This must be (an abbreviation of) one of the strings
    <code>"everything"</code>, <code>"all.obs"</code>, <code>"complete.obs"</code>,
    <code>"na.or.complete"</code>, or <code>"pairwise.complete.obs"</code>.</p></dd>

  <dt>method</dt>
<dd><p>a character string indicating which correlation
    coefficient (or covariance) is to be computed.  One of
    <code>"pearson"</code> (default), <code>"kendall"</code>, or <code>"spearman"</code>:
    can be abbreviated.</p></dd>


</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>For <code>r &lt;- Cor(*, use = "all.obs")</code>, it is now guaranteed that</p>
<p></p>
<p><code>all(abs(r) &lt;= 1)</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>For <code>Cov</code> and <code>Cor</code> one must <em>either</em> give a matrix or
  data frame for <code>x</code> <em>or</em> give both <code>x</code> and <code>y</code>.</p>
<p>The inputs must be numeric (as determined by <code><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></code>:
  logical values are also allowed for historical compatibility): the
  <code>"kendall"</code> and <code>"spearman"</code> methods make sense for ordered
  inputs but <code><a href="https://rdrr.io/r/base/xtfrm.html" class="external-link">xtfrm</a></code> can be used to find a suitable prior
  transformation to numbers.</p>
<p>If <code>use</code> is <code>"everything"</code>, <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">NA</a></code>s will
  propagate conceptually, i.e., a resulting value will be <code>NA</code>
  whenever one of its contributing observations is <code>NA</code>.<br>
  If <code>use</code> is <code>"all.obs"</code>, then the presence of missing
  observations will produce an error.  If <code>use</code> is
  <code>"complete.obs"</code> then missing values are handled by casewise
  deletion (and if there are no complete cases, that gives an error).
  <br><code>"na.or.complete"</code> is the same unless there are no complete
  cases, that gives <code>NA</code>.
  Finally, if <code>use</code> has the value <code>"pairwise.complete.obs"</code>
  then the correlation or covariance between each pair of variables is
  computed using all complete pairs of observations on those variables.
  This can result in covariance or correlation matrices which are not positive
  semi-definite, as well as <code>NA</code> entries if there are no complete
  pairs for that pair of variables.   For <code>Cov</code> and <code>Var</code>,
  <code>"pairwise.complete.obs"</code> only works with the <code>"pearson"</code>
  method.
  Note that (the equivalent of) <code>Var(double(0), use = *)</code> gives
  <code>NA</code> for <code>use = "everything"</code> and <code>"na.or.complete"</code>,
  and gives an error in the other cases.</p>
<p>The denominator \(n - 1\) is used which gives an unbiased estimator
  of the (co)variance for i.i.d. observations.
  These functions return <code><a href="https://rdrr.io/r/base/NA.html" class="external-link">NA</a></code> when there is only one
  observation (whereas S-PLUS has been returning <code>NaN</code>), and
  fail if <code>x</code> has length zero.</p>
<p>For <code>Cor()</code>, if <code>method</code> is <code>"kendall"</code> or
  <code>"spearman"</code>, Kendall's \(\tau\) or Spearman's
  \(\rho\) statistic is used to estimate a rank-based measure of
  association.  These are more robust and have been recommended if the
  data do not necessarily come from a bivariate normal distribution.<br>
  For <code>Cov()</code>, a non-Pearson method is unusual but available for
  the sake of completeness.  Note that <code>"spearman"</code> basically
  computes <code>Cor(R(x), R(y))</code> (or <code>Cov(., .)</code>) where <code>R(u)
  := rank(u, na.last = "keep")</code>. In the case of missing values, the
  ranks are calculated depending on the value of <code>use</code>, either
  based on complete observations, or based on pairwise completeness with
  reranking for each pair.</p>
<p>Scaling a covariance matrix into a correlation one can be achieved in
  many ways, mathematically most appealing by multiplication with a
  diagonal matrix from left and right, or more efficiently by using
  <code><a href="https://rdrr.io/r/base/sweep.html" class="external-link">sweep</a>(.., FUN = "/")</code> twice.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Some people have noted that the code for Kendall's tau is slow for
  very large datasets (many more than 1000 cases).  It rarely makes
  sense to do such a computation, but see function
  <code>cor.fk</code> in package <a href="https://CRAN.R-project.org/package=pcaPP" class="external-link"><span class="pkg">pcaPP</span></a>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Becker, R. A., Chambers, J. M. and Wilks, A. R. (1988)
  <em>The New S Language</em>.
  Wadsworth &amp; Brooks/Cole.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index">


<p><code><a href="https://rdrr.io/r/stats/cor.test.html" class="external-link">cor.test</a></code> for confidence intervals (and tests).</p>
<p><code><a href="https://rdrr.io/r/stats/cov.wt.html" class="external-link">cov.wt</a></code> for <em>weighted</em> covariance computation.</p>
<p><code><a href="Var.html">Var</a></code>, <code><a href="SD.html">SD</a></code> for variance and standard deviation (vectors).</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Two simple vectors</span></span></span>
<span class="r-in"><span><span class="fu">Cor</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span> <span class="co"># == 1</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Correlation Matrix of Multivariate sample:</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">Cl</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">longley</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              GNP.deflator       GNP Unemployed Armed.Forces Population</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP.deflator    1.0000000 0.9915892  0.6206334    0.4647442  0.9791634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP             0.9915892 1.0000000  0.6042609    0.4464368  0.9910901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unemployed      0.6206334 0.6042609  1.0000000   -0.1774206  0.6865515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Armed.Forces    0.4647442 0.4464368 -0.1774206    1.0000000  0.3644163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population      0.9791634 0.9910901  0.6865515    0.3644163  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Year            0.9911492 0.9952735  0.6682566    0.4172451  0.9939528</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Employed        0.9708985 0.9835516  0.5024981    0.4573074  0.9603906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Year  Employed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP.deflator 0.9911492 0.9708985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP          0.9952735 0.9835516</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unemployed   0.6682566 0.5024981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Armed.Forces 0.4172451 0.4573074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population   0.9939528 0.9603906</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Year         1.0000000 0.9713295</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Employed     0.9713295 1.0000000</span>
<span class="r-in"><span><span class="co">## Graphical Correlation Matrix:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">Cl</span><span class="op">)</span> <span class="co"># highly correlated</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              GNP. GNP U A P Y E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP.deflator 1                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP          B    1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unemployed   ,    ,   1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Armed.Forces .    .     1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population   B    B   , . 1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Year         B    B   , . B 1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Employed     B    B   . . B B 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Spearman's rho  and  Kendall's tau</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">clS</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">longley</span>, method <span class="op">=</span> <span class="st">"spearman"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              GNP. GNP U A P Y E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP.deflator 1                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP          B    1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unemployed   ,    ,   1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Armed.Forces          . 1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population   B    B   ,   1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Year         B    B   ,   1 1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Employed     B    B   .   B B 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">clK</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">longley</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              GNP. GNP U A P Y E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP.deflator 1                 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GNP          B    1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Unemployed   .    .   1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Armed.Forces            1      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Population   B    B   .   1    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Year         B    B   .   1 1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Employed     *    *   .   + + 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span><span class="co">## How much do they differ?</span></span></span>
<span class="r-in"><span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html" class="external-link">lower.tri</a></span><span class="op">(</span><span class="va">Cl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">Cor</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">Cl</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, S <span class="op">=</span> <span class="va">clS</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, K <span class="op">=</span> <span class="va">clK</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           P         S         K</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> P 1.0000000 0.9802390 0.9572562</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S 0.9802390 1.0000000 0.9742171</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K 0.9572562 0.9742171 1.0000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##--- Missing value treatment:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">C1</span> <span class="op">&lt;-</span> <span class="fu">Cov</span><span class="op">(</span><span class="va">swiss</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">C1</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="co"># 6.19        1921</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]    6.191249 1921.562488</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## swM := "swiss" with  3 "missing"s :</span></span></span>
<span class="r-in"><span><span class="va">swM</span> <span class="op">&lt;-</span> <span class="va">swiss</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">swM</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/abbreviate.html" class="external-link">abbreviate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">swiss</span><span class="op">)</span>, min<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">swM</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">swM</span><span class="op">[</span><span class="fl">7</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">swM</span><span class="op">[</span><span class="fl">25</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> <span class="co"># create 3 "missing"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Consider all 5 "use" cases :</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="va">C.</span> <span class="op">&lt;-</span> <span class="fu">Cov</span><span class="op">(</span><span class="va">swM</span><span class="op">)</span><span class="op">)</span> <span class="co"># use="everything"  quite a few NA's in cov.matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Frtlty Agrclt Exmntn     Eductn Cathlc    Infn.M</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frtlty 156.04250     NA     NA -79.729510     NA 15.156193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Agrclt        NA     NA     NA         NA     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exmntn        NA     NA     NA         NA     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eductn -79.72951     NA     NA  92.456059     NA -2.781684</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cathlc        NA     NA     NA         NA     NA        NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Infn.M  15.15619     NA     NA  -2.781684     NA  8.483802</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">Cov</span><span class="op">(</span><span class="va">swM</span>, use <span class="op">=</span> <span class="st">"all"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Error: missing obs...</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in Cov(swM, use = "all") : missing observations in cov/cor</span>
<span class="r-in"><span><span class="va">C2</span> <span class="op">&lt;-</span> <span class="fu">Cov</span><span class="op">(</span><span class="va">swM</span>, use <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">C2</span>, <span class="fu">Cov</span><span class="op">(</span><span class="va">swM</span>, use <span class="op">=</span> <span class="st">"na.or.complete"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">C2</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="co"># 6.46   1930</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]    6.462385 1930.505982</span>
<span class="r-in"><span><span class="va">C3</span> <span class="op">&lt;-</span> <span class="fu">Cov</span><span class="op">(</span><span class="va">swM</span>, use <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">C3</span>, only.values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span><span class="op">)</span> <span class="co"># 6.19   1938</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]    6.194469 1938.033663</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Kendall's tau doesn't change much:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">Rc</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">swM</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, use <span class="op">=</span> <span class="st">"complete"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        F A Ex Ed C I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frtlty 1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Agrclt   1          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exmntn . . 1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eductn . . .  1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cathlc     .     1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Infn.M             1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">Rp</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">swM</span>, method <span class="op">=</span> <span class="st">"kendall"</span>, use <span class="op">=</span> <span class="st">"pairwise"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        F A Ex Ed C I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Frtlty 1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Agrclt   1          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Exmntn . . 1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eductn . . .  1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cathlc     .     1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Infn.M .           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/symnum.html" class="external-link">symnum</a></span><span class="op">(</span><span class="va">R.</span> <span class="op">&lt;-</span> <span class="fu">Cor</span><span class="op">(</span><span class="va">swiss</span>, method <span class="op">=</span> <span class="st">"kendall"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  F A Ex Ed C I</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fertility        1            </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Agriculture        1          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Examination      . . 1        </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Education        . . .  1     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Catholic             .     1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Infant.Mortality .           1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"legend")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0 ‘ ’ 0.3 ‘.’ 0.6 ‘,’ 0.8 ‘+’ 0.9 ‘*’ 0.95 ‘B’ 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## "pairwise" is closer componentwise,</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Rp</span><span class="op">/</span><span class="va">R.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000 0.00000 0.04481 0.09573 0.15214 0.53941 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">Rc</span><span class="op">/</span><span class="va">R.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.00000 0.02021 0.08482 0.50675 0.16192 7.08509 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## but "complete" is closer in Eigen space:</span></span></span>
<span class="r-in"><span><span class="va">EV</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/eigen.html" class="external-link">eigen</a></span><span class="op">(</span><span class="va">m</span>, only.values<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">EV</span><span class="op">(</span><span class="va">Rp</span><span class="op">)</span><span class="op">/</span><span class="fu">EV</span><span class="op">(</span><span class="va">R.</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu">EV</span><span class="op">(</span><span class="va">Rc</span><span class="op">)</span><span class="op">/</span><span class="fu">EV</span><span class="op">(</span><span class="va">R.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.8942  1.1464  1.2452  1.3732  1.3722  2.3265 </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

