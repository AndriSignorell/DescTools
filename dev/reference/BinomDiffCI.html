<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Confidence Interval for a Difference of Binomials
 — BinomDiffCI • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Confidence Interval for a Difference of Binomials
 — BinomDiffCI" />
<meta property="og:description" content="Several confidence intervals for the difference between proportions are available, but they can produce markedly different results. Traditional approaches, such as the Wald interval do not perform well unless the sample size is large. Better intervals are available. These include the Agresti/Caffo method (2000), Newcombe Score method (1998) and more computing intensive ones as by Miettinen and Nurminen (1985) or Mee (1984). The latter ones are favoured by Newcombe (when forced to choose between a rock and a hard place).
" />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.40.10</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence Interval for a Difference of Binomials
<!-- %%  ~~function to do ... ~~ --></h1>
    
    <div class="hidden name"><code>BinomDiffCI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Several confidence intervals for the difference between proportions are available, but they can produce markedly different results. Traditional approaches, such as the Wald interval do not perform well unless the sample size is large. Better intervals are available. These include the Agresti/Caffo method (2000), Newcombe Score method (1998) and more computing intensive ones as by Miettinen and Nurminen (1985) or Mee (1984). The latter ones are favoured by Newcombe (when forced to choose between a rock and a hard place).
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <pre class="usage"><span class='fu'>BinomDiffCI</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>n1</span>, <span class='va'>x2</span>, <span class='va'>n2</span>, conf.level <span class='op'>=</span> <span class='fl'>0.95</span>, sides <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"two.sided"</span>,<span class='st'>"left"</span>,<span class='st'>"right"</span><span class='op'>)</span>,
            method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"ac"</span>, <span class='st'>"wald"</span>, <span class='st'>"waldcc"</span>, <span class='st'>"score"</span>, <span class='st'>"scorecc"</span>, <span class='st'>"mn"</span>,
                       <span class='st'>"mee"</span>, <span class='st'>"blj"</span>, <span class='st'>"ha"</span>, <span class='st'>"hal"</span>, <span class='st'>"jp"</span><span class='op'>)</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x1</th>
      <td><p>number of successes for the first group.</p></td>
    </tr>
    <tr>
      <th>n1</th>
      <td><p>number of trials for the first group.</p></td>
    </tr>
    <tr>
      <th>x2</th>
      <td><p>number of successes for the second group.</p></td>
    </tr>
    <tr>
      <th>n2</th>
      <td><p>number of trials for the second group.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>confidence level, defaults to 0.95.</p></td>
    </tr>
    <tr>
      <th>sides</th>
      <td><p>a character string specifying the side of the confidence interval, must be one of <code>"two.sided"</code> (default),
<code>"left"</code> or <code>"right"</code>. You can specify just the initial letter. <code>"left"</code> would be analogue to a hypothesis of
<code>"greater"</code> in a <code>t.test</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>one of <code>"wald"</code>, <code>"waldcc"</code>, <code>"ac"</code>, <code>"score"</code>, <code>"scorecc"</code>, <code>"mn"</code>, <code>"mee"</code>, <code>"blj"</code>, <code>"ha"</code>, <code>"hal"</code>, <code>"jp"</code>.
<!-- %%     ~~Describe \code{method} here~~ --></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All arguments are being recycled.</p>
<p>We estimate the difference between proportions using the sample proportions:
 $$\hat{\delta} =\hat{p}_1 - \hat{p}_2 = \frac{x_1}{n_1} - \frac{x_2}{n_2}$$</p>
<p>The traditional <b>Wald </b> confidence interval for the difference of two proportions \(\delta\) is based on the asymptotic normal distribution of \(\hat{\delta}\).</p>
<p>The <b>Corrected Wald</b> interval uses a continuity correction included in the test statistic. The continuity correction is subtracted from the numerator of the test statistic if the numerator is greater than zero; otherwise, the continuity correction is added to the numerator. The value of the continuity correction is (1/n1 + 1/n2)/2.</p>
<p>The <b>Agresti-Caffo</b> (code <code>"ac"</code>) is equal to the Wald interval with the adjustment according to Agresti, Caffo (2000) for difference in proportions and independent samples. It adds 1 to x1 and x2 and adds 2 to n1 and n2 and performs surpringly well.</p>
<p><b>Newcombe</b> (code <code>"scorecc"</code>) proposed a confidence interval for the difference based on the Wilson score confidence interval for a single proportion. A variant uses a continuity correction for the Wilson interval (code <code>"scorecc"</code>).</p>
<p><b>Miettinen and Nurminen</b> showed that the restricted maximum likelihood estimates for p1 and p2 can
be obtained by solving a cubic equation and gave unique closed-form expressions for them. The Miettinen-Nurminen confidence interval is returned with code <code>"mn"</code>.</p>
<p>The <b>Mee</b> (code <code>"mee"</code>) interval proposed by Mee (1984) and Farrington-Manning (1990) is using the same maximum likelihood estimators as Miettinen-Nurminen but with another correcting factor.</p>
<p>The <b>Brown, Li's Jeffreys</b> (code <code>"blj"</code>) interval was proposed by Brown, Li's Jeffreys (2005).</p>
<p>The <b>Hauck-Anderson</b> (code <code>"ha"</code>) interval was proposed by Hauck-Anderson (1986).</p>
<p>The <b>Haldane</b> (code <code>"hal"</code>) interval is described in Newcombe (1998) and so is
the <b>Jeffreys-Perks</b> (code <code>"jp"</code>).</p>
<p>Some approaches for the confidence intervals can potentially yield negative results or values beyond [-1, 1]. These would be reset such as not to exceed the range of [-1, 1].</p>
<p>Which of the methods to use is currently still the subject of lively discussion and has not yet been conclusively clarified. See e.g. Fagerland (2011).</p>
<p>The general consensus is that the most widely taught method <code>method="wald"</code> is inappropriate in many situations and should not be used. Recommendations seem to converge around the Miettinen-Nurminen based methods (<code>method="mn"</code>).</p>

<p><!-- %%  ~~ If necessary, more details than the description above ~~ --></p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A matrix with 3 columns containing the estimate, the lower and the upper confidence intervall.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Agresti, A, Caffo, B (2000) Simple and effective confidence intervals for proportions and difference of proportions result from adding two successes and two failures. <em>The American Statistician</em> 54 (4), 280-288.</p>
<p>Beal, S L (1987) Asymptotic Confidence Intervals for the Difference Between Two Binomial Parameters for Use with Small Samples;  <em>Biometrics</em>, 43, 941-950.</p>
<p>Brown L, Li X (2005) Confidence intervals for two sample binomial distribution, <em>Journal of Statistical Planning and Inference</em>, 130(1), 359-375.</p>
<p>Hauck WW, Anderson S. (1986) A comparison of large-sample confidence interval methods for the difference of two binomial probabilities <em>The American Statistician</em> 40(4): 318-322.</p>
<p>Farrington, C. P. and Manning, G. (1990) Test Statistics and Sample Size Formulae for Comparative Binomial Trials with Null Hypothesis of Non-zero Risk Difference or Non-unity Relative Risk <em>Statistics in Medicine</em>, 9, 1447-1454.</p>
<p>Mee RW (1984) Confidence bounds for the difference between two probabilities, <em>Biometrics</em> 40:1175-1176 .</p>
<p>Miettinen OS, Nurminen M. (1985) Comparative analysis of two rates. <em>Statistics in Medicine</em> 4, 213-226.</p>
<p>Newcombe, R G (1998). Interval Estimation for the Difference Between Independent Proportions: Comparison of Eleven Methods. <em>Statistics in Medicine</em>, 17, 873--890.</p>
<p>Fagerland M W, Lydersen S and Laake P (2011) Recommended confidence intervals for two independent binomial proportions, <em>Statistical Methods in Medical Research</em> 0(0) 1-31</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Andri Signorell &lt;andri@signorell.net&gt;
<!-- %%  ~~who you are~~ --></p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='BinomCI.html'>BinomCI</a></code>,  <code><a href='MultinomCI.html'>MultinomCI</a></code>,  <code><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></code>,
<code><a href='https://rdrr.io/r/stats/prop.test.html'>prop.test</a></code>, <code><a href='BinomRatioCI.html'>BinomRatioCI</a></code>
<!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ --></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>56</span>; <span class='va'>n1</span> <span class='op'>&lt;-</span> <span class='fl'>70</span>; <span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fl'>48</span>; <span class='va'>n2</span> <span class='op'>&lt;-</span> <span class='fl'>80</span>
<span class='va'>xci</span> <span class='op'>&lt;-</span> <span class='fu'>BinomDiffCI</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>n1</span>, <span class='va'>x2</span>, <span class='va'>n2</span>, method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wald"</span>, <span class='st'>"waldcc"</span>, <span class='st'>"ac"</span>, <span class='st'>"score"</span>,
            <span class='st'>"scorecc"</span>, <span class='st'>"mn"</span>, <span class='st'>"mee"</span>, <span class='st'>"blj"</span>, <span class='st'>"ha"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='Format.html'>Format</a></span><span class='op'>(</span><span class='va'>xci</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, digits<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         lwr.ci upr.ci
#&gt; wald    0.0575 0.3425
#&gt; waldcc  0.0441 0.3559
#&gt; ac      0.0525 0.3358
#&gt; score   0.0524 0.3339
#&gt; scorecc 0.0428 0.3422
#&gt; mn      0.0528 0.3382
#&gt; mee     0.0534 0.3377
#&gt; blj     0.0540 0.3400
#&gt; ha      0.0494 0.3506
#&gt; attr(,"class")
#&gt; [1] matrix  array</div><div class='input'>
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fl'>9</span>; <span class='va'>n1</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>; <span class='va'>x2</span> <span class='op'>&lt;-</span> <span class='fl'>3</span>; <span class='va'>n2</span> <span class='op'>&lt;-</span> <span class='fl'>10</span>
<span class='va'>yci</span> <span class='op'>&lt;-</span> <span class='fu'>BinomDiffCI</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>n1</span>, <span class='va'>x2</span>, <span class='va'>n2</span>, method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wald"</span>, <span class='st'>"waldcc"</span>, <span class='st'>"ac"</span>, <span class='st'>"score"</span>,
            <span class='st'>"scorecc"</span>, <span class='st'>"mn"</span>, <span class='st'>"mee"</span>, <span class='st'>"blj"</span>, <span class='st'>"ha"</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='Format.html'>Format</a></span><span class='op'>(</span><span class='va'>yci</span><span class='op'>[</span>, <span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, digits<span class='op'>=</span><span class='fl'>4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;         lwr.ci upr.ci
#&gt; wald    0.2605 0.9395
#&gt; waldcc  0.1605 1.0000
#&gt; ac      0.1600 0.8400
#&gt; score   0.1705 0.8090
#&gt; scorecc 0.1013 0.8387
#&gt; mn      0.1700 0.8406
#&gt; mee     0.1821 0.8370
#&gt; blj     0.1869 0.9040
#&gt; ha      0.1922 1.0000
#&gt; attr(,"class")
#&gt; [1] matrix  array</div><div class='input'>
<span class='co'># https://www.lexjansen.com/wuss/2016/127_Final_Paper_PDF.pdf, page 9</span>
<span class='fu'><a href='SetNames.html'>SetNames</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span>
  <span class='fu'>BinomDiffCI</span><span class='op'>(</span><span class='fl'>56</span>, <span class='fl'>70</span>, <span class='fl'>48</span>, <span class='fl'>80</span>, 
              method<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"wald"</span>, <span class='st'>"waldcc"</span>, <span class='st'>"hal"</span>, 
                       <span class='st'>"jp"</span>, <span class='st'>"mee"</span>,
                       <span class='st'>"mn"</span>, <span class='st'>"score"</span>, <span class='st'>"scorecc"</span>, 
                       <span class='st'>"ha"</span>, <span class='st'>"ac"</span>, <span class='st'>"blj"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>[</span>,<span class='op'>-</span><span class='fl'>1</span><span class='op'>]</span>, <span class='fl'>4</span><span class='op'>)</span>,
  rownames<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"1. Wald, no CC"</span>, <span class='st'>"2. Wald, CC"</span>, <span class='st'>"3. Haldane"</span>, <span class='st'>"4. Jeffreys-Perks"</span>,
             <span class='st'>"5. Mee"</span>, <span class='st'>"6. Miettinen-Nurminen"</span>, <span class='st'>"10. Score, no CC"</span>, <span class='st'>"11. Score, CC"</span>,
             <span class='st'>"12. Hauck-Andersen"</span>, <span class='st'>"13. Agresti-Caffo"</span>, <span class='st'>"16. Brown-Li"</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt;                       lwr.ci upr.ci
#&gt; 1. Wald, no CC        0.0575 0.3425
#&gt; 2. Wald, CC           0.0441 0.3559
#&gt; 3. Haldane            0.0535 0.3351
#&gt; 4. Jeffreys-Perks     0.0531 0.3355
#&gt; 5. Mee                0.0534 0.3377
#&gt; 6. Miettinen-Nurminen 0.0528 0.3382
#&gt; 10. Score, no CC      0.0524 0.3339
#&gt; 11. Score, CC         0.0428 0.3422
#&gt; 12. Hauck-Andersen    0.0494 0.3506
#&gt; 13. Agresti-Caffo     0.0525 0.3358
#&gt; 16. Brown-Li          0.0540 0.3400</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


