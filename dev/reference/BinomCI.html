<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Confidence Intervals for Binomial Proportions — BinomCI • DescTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Confidence Intervals for Binomial Proportions — BinomCI"><meta property="og:description" content="Compute confidence intervals for binomial proportions according to a number of the most common proposed methods."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.58.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>


    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf" class="external-link">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf" class="external-link">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf" class="external-link">Combinatorics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AndriSignorell/DescTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Confidence Intervals for Binomial Proportions</h1>

    <div class="hidden name"><code>BinomCI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute confidence intervals for binomial proportions according to a number of the most common proposed methods.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">BinomCI</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, sides <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"two.sided"</span>, <span class="st">"left"</span>, <span class="st">"right"</span><span class="op">)</span>,</span>
<span>        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wilson"</span>, <span class="st">"wald"</span>, <span class="st">"waldcc"</span>, <span class="st">"agresti-coull"</span>, <span class="st">"jeffreys"</span>,</span>
<span>                   <span class="st">"modified wilson"</span>, <span class="st">"wilsoncc"</span>,<span class="st">"modified jeffreys"</span>,</span>
<span>                   <span class="st">"clopper-pearson"</span>, <span class="st">"arcsine"</span>, <span class="st">"logit"</span>, <span class="st">"witting"</span>, <span class="st">"pratt"</span>, </span>
<span>                   <span class="st">"midp"</span>, <span class="st">"lik"</span>, <span class="st">"blaker"</span><span class="op">)</span>,</span>
<span>        rand <span class="op">=</span> <span class="fl">123</span>, tol <span class="op">=</span> <span class="fl">1e-05</span>, std_est <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>number of successes.</p></dd>

  <dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>number of trials.</p></dd>

  <dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>confidence level, defaults to 0.95.</p></dd>

  <dt id="arg-sides">sides<a class="anchor" aria-label="anchor" href="#arg-sides"></a></dt>
<dd><p>a character string specifying the side of the confidence interval, must be one of <code>"two.sided"</code> (default),
<code>"left"</code> or <code>"right"</code>. You can specify just the initial letter. <code>"left"</code> would be analogue to a hypothesis of
<code>"greater"</code> in a <code>t.test</code>.</p></dd>


  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string specifing which method to use; this can be one out of:
  <code>"wald"</code>, <code>"wilson"</code> (default), <code>"wilsoncc"</code>, <code>"agresti-coull"</code>, <code>"jeffreys"</code>,
  <code>"modified wilson"</code>, <code>"modified jeffreys"</code>, <code>"clopper-pearson"</code>,
  <code>"arcsine"</code>, <code>"logit"</code>, <code>"witting"</code>, <code>"pratt"</code>, <code>"midp"</code>, <code>"lik"</code> and <code>"blaker"</code>.
  Abbreviation of method is accepted. See details.</p></dd>


  <dt id="arg-rand">rand<a class="anchor" aria-label="anchor" href="#arg-rand"></a></dt>
<dd><p>seed for random number generator; see details.</p></dd>

  <dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>tolerance for method <code>"blaker"</code>.</p></dd>


  <dt id="arg-std-est">std_est<a class="anchor" aria-label="anchor" href="#arg-std-est"></a></dt>
<dd><p>logical, specifying if the standard point estimator for the proportion value <code>x/n</code> should be returned (<code>TRUE</code>, default) or the method-specific internally used alternative point estimate (<code>FALSE</code>).</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>All arguments are being recycled.</p>
<p>The <b>Wald </b> interval is obtained by inverting the acceptance region of the Wald
  large-sample normal test.</p>
<p>The <b>Wald with continuity correction </b> interval is obtained by adding the term 1/(2*n) to the Wald interval.</p>
<p>The <b>Wilson</b> interval, which here is the default method, was introduced by Wilson (1927) and is the inversion of the CLT approximation to the family of equal tail tests of p = p0.
  The Wilson interval is recommended by Agresti and Coull (1998) as well as by
  Brown et al (2001). It is also returned as <code>conf.int</code> from the function <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> with the <code>correct</code> option set to <code>FALSE</code>.</p>
<p>The <b>Wilson cc</b> interval is a modification of the Wilson interval adding a continuity correction term. This is returned as <code>conf.int</code> from the function <code><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></code> with the <code>correct</code> option set to <code>TRUE</code>.</p>
<p>The <b>modified Wilson</b> interval is a modification of the Wilson interval for x close to 0
  or n as proposed by Brown et al (2001).</p>
<p>The <b>Agresti-Coull</b> interval was proposed by Agresti and Coull (1998) and is a slight
  modification of the Wilson interval. The Agresti-Coull intervals are never shorter
  than the Wilson intervals; cf. Brown et al (2001). The internally used point estimator p-tilde is returned as attribute.</p>
<p>The <b>Jeffreys</b> interval is an implementation of the equal-tailed Jeffreys prior interval
  as given in Brown et al (2001).</p>
<p>The <b>modified Jeffreys</b> interval is a modification of the Jeffreys interval for
  <code>x == 0 | x == 1</code> and <code>x == n-1 | x == n</code> as proposed by
  Brown et al (2001).</p>
<p>The <b>Clopper-Pearson</b> interval is based on quantiles of corresponding beta
  distributions. This is sometimes also called exact interval.</p>
<p>The <b>arcsine</b> interval is based on the variance stabilizing distribution for the binomial
  distribution.</p>
<p>The <b>logit</b> interval is obtained by inverting the Wald type interval for the log odds.</p>
<p>The <b>Witting</b> interval (cf. Beispiel 2.106 in Witting (1985)) uses randomization to
  obtain uniformly optimal lower and upper confidence bounds (cf. Satz 2.105 in
  Witting (1985)) for binomial proportions.</p>
<p>The <b>Pratt</b> interval is obtained by extremely accurate normal approximation. (Pratt 1968)</p>
<p>The <b>Mid-p</b> approach is used to reduce the conservatism of the Clopper-Pearson, which is known to be very pronounced. The method midp accumulates the tail areas.
  The lower bound \(p_l\) is found as the solution to the equation
  $$\frac{1}{2} f(x;n,p_l) + (1-F(x;m,p_l)) = \frac{\alpha}{2}$$
  where \(f(x;n,p)\) denotes the probability mass function (pmf) and
  \(F(x;n,p)\) the (cumulative) distribution function of the binomial
  distribution with size \(n\) and proportion \(p\) evaluated at
  \(x\).
  The upper bound \(p_u\) is found as the solution to the equation
  $$\frac{1}{2} f(x;n,p_u) + F(x-1;m,p_u) = \frac{\alpha}{2}$$
   In case x=0 then the lower bound is
  zero and in case x=n then the upper bound is 1.</p>
<p>The <b>Likelihood-based</b> approach is said to be theoretically appealing. Confidence intervals are based on profiling the binomial deviance in the neighbourhood of the
MLE.</p>
<p>For the <b>Blaker</b> method refer to Blaker (2000).</p>

<p>For more details we refer to Brown et al (2001) as well as Witting (1985).</p>


<p>Some approaches for the confidence intervals are capable of violating the [0, 1] boundaries and potentially yield negative results or values beyond 1. These would be truncated such as not to exceed the valid range of [0, 1].</p>
<p>So now, which interval should we use? The Wald interval often has inadequate coverage, particularly for small n and values of p close to 0 or 1. Conversely, the Clopper-Pearson Exact method is very conservative and tends to produce wider intervals than necessary. Brown et al. recommends the Wilson or Jeffreys methods for small n and Agresti-Coull, Wilson, or Jeffreys, for larger n as providing more reliable coverage than the alternatives.</p>
<p>For the methods <code>"wilson"</code>, <code>"wilsoncc"</code>, <code>"modified wilson"</code>, <code>"agresti-coull"</code> and <code>"arcsine"</code> the internally used alternative point estimator for the proportion value can be returned (by setting <code>std_est = FALSE</code>). The point estimate typically is slightly shifted towards 0.5 compared to the standard estimator. See the literature for the more details.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector with 3 elements for estimate, lower confidence intervall and upper for the upper one.</p>
<p>For more than one argument each, a 3-column matrix is returned.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The base of this function once was <code>binomCI()</code> from the <span class="pkg">SLmisc</span> package. In the meantime, the code has been updated on several occasions and it has undergone numerous extensions and bug fixes.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Agresti A. and Coull B.A. (1998) Approximate is better than "exact" for interval
  estimation of binomial proportions.
  <em>American Statistician</em>, <b>52</b>, pp. 119-126.</p>
<p>Brown L.D., Cai T.T. and Dasgupta A. (2001) Interval estimation for a binomial
  proportion <em>Statistical Science</em>, <b>16</b>(2), pp. 101-133.</p>
<p>Witting H. (1985) <em>Mathematische Statistik I</em>. Stuttgart: Teubner.</p>
<p>Pratt J. W. (1968) A normal approximation for binomial, F, Beta, and other
common, related tail probabilities <em>Journal of the American Statistical Association</em>, 63, 1457-
1483.</p>
<p>Wilcox, R. R. (2005) <em>Introduction to robust estimation and hypothesis testing</em>. Elsevier Academic Press</p>
<p>Newcombe, R. G. (1998) Two-sided confidence intervals for the single proportion: comparison of seven methods, <em>Statistics in Medicine</em>, 17:857-872
https://pubmed.ncbi.nlm.nih.gov/16206245/</p>
<p>Blaker, H. (2000) Confidence curves and improved exact confidence intervals for discrete distributions, <em>Canadian Journal of Statistics</em> 28 (4), 783-798</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Matthias Kohl &lt;Matthias.Kohl@stamats.de&gt;,
Rand R. Wilcox (Pratt's method), Michael Hoehle &lt;hoehle@math.su.se&gt; (Mid-p),
Ralph Scherer &lt;shearer.ra76@gmail.com&gt; (Blaker),
Andri Signorell &lt;andri@signorell.net&gt; (interface issues and all the rest)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></code>, <code>binconf</code>, <code><a href="MultinomCI.html">MultinomCI</a></code>,  <code><a href="BinomDiffCI.html">BinomDiffCI</a></code>, <code><a href="BinomRatioCI.html">BinomRatioCI</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">BinomCI</span><span class="op">(</span>x<span class="op">=</span><span class="fl">37</span>, n<span class="op">=</span><span class="fl">43</span>, </span></span>
<span class="r-in"><span>        method<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/formals.html" class="external-link">formals</a></span><span class="op">(</span><span class="va">BinomCI</span><span class="op">)</span><span class="op">$</span><span class="va">method</span><span class="op">)</span><span class="op">)</span>   <span class="co"># return all methods</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         est    lwr.ci    upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wilson            0.8604651 0.7273641 0.9344428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wald              0.8604651 0.7568980 0.9640322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waldcc            0.8604651 0.7452701 0.9756601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> agresti-coull     0.8604651 0.7235600 0.9382469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> jeffreys          0.8604651 0.7348110 0.9395927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> modified wilson   0.8604651 0.7273641 0.9344428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wilsoncc          0.8604651 0.7137335 0.9419725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> modified jeffreys 0.8604651 0.7348110 0.9395927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clopper-pearson   0.8604651 0.7206752 0.9470234</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> arcsine           0.8604651 0.7346862 0.9424696</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> logit             0.8604651 0.7224337 0.9359412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> witting           0.8604651 0.7493378 0.9273288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pratt             0.8604651 0.7661306 0.9472522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> midp              0.8604651 0.7321815 0.9414281</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lik               0.8604651 0.7372546 0.9420472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> blaker            0.8604651 0.7255152 0.9374534</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">37</span>, n<span class="op">=</span><span class="fl">43</span>, correct<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># same as method wilson</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	1-sample proportions test without continuity correction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  37 out of 43, null probability 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 22.349, df = 1, p-value = 0.000002274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true p is not equal to 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7273641 0.9344428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8604651 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/prop.test.html" class="external-link">prop.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">37</span>, n<span class="op">=</span><span class="fl">43</span>, correct<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>  <span class="co"># same as method wilsoncc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	1-sample proportions test with continuity correction</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  37 out of 43, null probability 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> X-squared = 20.93, df = 1, p-value = 0.000004763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true p is not equal to 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  0.7137335 0.9419725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         p </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.8604651 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the confidence interval computed by binom.test</span></span></span>
<span class="r-in"><span><span class="co">#   corresponds to the Clopper-Pearson interval</span></span></span>
<span class="r-in"><span><span class="fu">BinomCI</span><span class="op">(</span>x<span class="op">=</span><span class="fl">42</span>, n<span class="op">=</span><span class="fl">43</span>, method<span class="op">=</span><span class="st">"clopper-pearson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            est    lwr.ci    upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9767442 0.8771095 0.9994114</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">42</span>, n<span class="op">=</span><span class="fl">43</span><span class="op">)</span><span class="op">$</span><span class="va">conf.int</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8771095 0.9994114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"conf.level")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.95</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># all arguments are being recycled:</span></span></span>
<span class="r-in"><span><span class="fu">BinomCI</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">35</span>, <span class="fl">23</span>, <span class="fl">22</span><span class="op">)</span>, n<span class="op">=</span><span class="fl">43</span>, method<span class="op">=</span><span class="st">"wilson"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           est    lwr.ci    upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.1 0.9767442 0.8794101 0.9958829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.2 0.8139535 0.6738300 0.9025825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.3 0.5348837 0.3891564 0.6748894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.4 0.5116279 0.3675231 0.6538255</span>
<span class="r-in"><span><span class="fu">BinomCI</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">42</span>, <span class="fl">35</span>, <span class="fl">23</span>, <span class="fl">22</span><span class="op">)</span>, n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">60</span>, <span class="fl">70</span>, <span class="fl">80</span><span class="op">)</span>, method<span class="op">=</span><span class="st">"jeffreys"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               est    lwr.ci    upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.1:n.1 0.8400000 0.7206737 0.9213325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.2:n.2 0.5833333 0.4571040 0.7017365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.3:n.3 0.3285714 0.2272016 0.4437899</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> x.4:n.4 0.2750000 0.1863875 0.3795587</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># example Table I in Newcombe (1998)</span></span></span>
<span class="r-in"><span><span class="va">meths</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wald"</span>, <span class="st">"waldcc"</span>, <span class="st">"wilson"</span>, <span class="st">"wilsoncc"</span>,</span></span>
<span class="r-in"><span>           <span class="st">"clopper-pearson"</span>,<span class="st">"midp"</span>, <span class="st">"lik"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">BinomCI</span><span class="op">(</span><span class="fl">81</span>, <span class="fl">263</span>, m<span class="op">=</span><span class="va">meths</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="fu">BinomCI</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">148</span>, m<span class="op">=</span><span class="va">meths</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="fu">BinomCI</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">20</span>, m<span class="op">=</span><span class="va">meths</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="fu">BinomCI</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">29</span>, m<span class="op">=</span><span class="va">meths</span><span class="op">)</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 lwr.ci upr.ci lwr.ci upr.ci lwr.ci upr.ci lwr.ci upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wald            0.2522 0.3638 0.0527 0.1500      0 0.0000 0.0000 0.1009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> waldcc          0.2503 0.3657 0.0494 0.1534      0 0.0250 0.0000 0.1181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wilson          0.2553 0.3662 0.0624 0.1605      0 0.1611 0.0061 0.1718</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> wilsoncc        0.2535 0.3682 0.0598 0.1644      0 0.2005 0.0018 0.1963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> clopper-pearson 0.2527 0.3676 0.0578 0.1617      0 0.1684 0.0009 0.1776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> midp            0.2544 0.3658 0.0601 0.1581      0 0.1391 0.0017 0.1585</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lik             0.2543 0.3655 0.0596 0.1567      0 0.0916 0.0020 0.1432</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># returning p.tilde for agresti-coull ci</span></span></span>
<span class="r-in"><span><span class="fu">BinomCI</span><span class="op">(</span>x<span class="op">=</span><span class="fl">81</span>, n<span class="op">=</span><span class="fl">263</span>, meth<span class="op">=</span><span class="st">"agresti-coull"</span>, std_est <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             est    lwr.ci    upr.ci</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TRUE  0.3079848 0.2552207 0.3662774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> FALSE 0.3107490 0.2552207 0.3662774</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

