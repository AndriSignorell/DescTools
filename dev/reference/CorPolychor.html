<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Polychoric Correlation — CorPolychor • DescTools</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Polychoric Correlation — CorPolychor"><meta property="og:description" content="Computes the polychoric correlation (and its standard error)
  between two ordinal variables or from their contingency table, under the 
  assumption that the ordinal variables dissect continuous latent variables that are bivariate normal. Either
  the maximum-likelihood estimator or a (possibly much) quicker ``two-step'' approximation is available. For the ML
  estimator, the estimates of the thresholds and the covariance matrix of the estimates are also available."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.99.52.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">Documentation for version of package:</li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/" class="external-link">Released</a>
    </li>
    <li>
      <a href="https://andrisignorell.github.io/DescTools/dev/" class="external-link">In-development</a>
    </li>
  </ul></li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li class="dropdown-header">PDF:</li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/DescToolsCompanion.pdf" class="external-link">Desc Tools Companion</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/TablesInR.pdf" class="external-link">Tables in R</a>
    </li>
    <li>
      <a href="https://github.com/AndriSignorell/DescTools/raw/master/vignettes/Combinatorics.pdf" class="external-link">Combinatorics</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/AndriSignorell/DescTools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Polychoric Correlation</h1>
    
    <div class="hidden name"><code>CorPolychor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the polychoric correlation (and its standard error)
  between two ordinal variables or from their contingency table, under the 
  assumption that the ordinal variables dissect continuous latent variables that are bivariate normal. Either
  the maximum-likelihood estimator or a (possibly much) quicker ``two-step'' approximation is available. For the ML
  estimator, the estimates of the thresholds and the covariance matrix of the estimates are also available.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CorPolychor</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ML <span class="op">=</span> <span class="cn">FALSE</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, std.err <span class="op">=</span> <span class="cn">FALSE</span>, maxcor<span class="op">=</span><span class="fl">.9999</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for CorPolychor</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a contingency table of counts or an ordered categorical variable; the latter can be numeric, logical, a factor,
    or an ordered factor, but if a factor, its levels should be in proper order.</p></dd>

  <dt>y</dt>
<dd><p>if <code>x</code> is a variable, a second ordered categorical variable.</p></dd>

  <dt>ML</dt>
<dd><p>if <code>TRUE</code>, compute the maximum-likelihood estimate; if <code>FALSE</code>, the default, compute a quicker
    ``two-step'' approximation.</p></dd>

  <dt>control</dt>
<dd><p>optional arguments to be passed to the <code>optim</code> function.</p></dd>

  <dt>std.err</dt>
<dd><p>if <code>TRUE</code>, return the estimated variance of the correlation (for the two-step estimator) 
    or the estimated covariance matrix (for the ML estimator) of the correlation and thresholds; the default is <code>FALSE</code>.</p></dd>

  <dt>maxcor</dt>
<dd><p>maximum absolute correlation (to insure numerical stability).</p></dd>

    <dt>digits</dt>
<dd><p>integer, determining the number of digits used to format the printed result</p></dd>

<dt>...</dt>
<dd><p>not used</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>std.err</code> is <code>TRUE</code>, 
  returns an object of class <code>"polycor"</code> with the following components:</p>
<dl><dt>type</dt>
<dd><p>set to <code>"polychoric"</code>.</p></dd>

  <dt>rho</dt>
<dd><p>the CorPolychoric correlation.</p></dd>

</dl><p><!-- %  \item{row.cuts}{estimated thresholds for the row variable (\code{x}), for the ML estimate.} --></p>


<p><!-- %  \item{col.cuts}{estimated thresholds for the column variable (\code{y}), for the ML estimate.} --></p>
<dl><dt>var</dt>
<dd><p>the estimated variance of the correlation, or, for the ML estimate, 
    the estimated covariance matrix of the correlation and thresholds.</p></dd>

  <dt>n</dt>
<dd><p>the number of observations on which the correlation is based.</p></dd>

  <dt>chisq</dt>
<dd><p>chi-square test for bivariate normality.</p></dd>

  <dt>df</dt>
<dd><p>degrees of freedom for the test of bivariate normality.</p></dd>

  <dt>ML</dt>
<dd><p><code>TRUE</code> for the ML estimate, <code>FALSE</code> for the two-step estimate.</p></dd>

</dl><p>Othewise, returns the polychoric correlation.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Drasgow, F. (1986) 
    CorPolychoric and polyserial correlations. 
    Pp. 68--74 in S. Kotz and N. Johnson, eds.,
    <em>The Encyclopedia of Statistics, Volume 7.</em> Wiley.</p>    
<p>Olsson, U. (1979)
    Maximum likelihood estimation of the CorPolychoric correlation coefficient.
    <em>Psychometrika</em> <b>44</b>, 443-460.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>This is a verbatim copy from polchor function in the package polycor.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>John Fox <a href="mailto:jfox@mcmaster.ca">jfox@mcmaster.ca</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code>hetcor</code>, <code>polyserial</code>, <code>print.CorPolychor</code>, <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="RndPairs.html">RndPairs</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">0.6</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">z</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">z</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>                                  <span class="co"># sample correlation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6161179</span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="fl">.75</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">1.5</span>, <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">CorPolychor</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>                          <span class="co"># 2-step estimate</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5911583</span>
<span class="r-in"><span><span class="fu">CorPolychor</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, ML<span class="op">=</span><span class="cn">TRUE</span>, std.err<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>   <span class="co"># ML estimate</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "polychoric"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rho</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.5911191 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $row.cuts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-Inf,0.75] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.7077541 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $col.cuts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  (-Inf,-1]   (-1,0.5]  (0.5,1.5] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.0168617  0.5122542  1.4805999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $var</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                             (-Inf,0.75]    (-Inf,-1]      (-1,0.5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              0.0012487057 -0.0001238037 0.0001830118 -0.0000473158</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-Inf,0.75] -0.0001238037  0.0018825207 0.0004473909  0.0006780769</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-Inf,-1]    0.0001830118  0.0004473909 0.0023096776  0.0005703172</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-1,0.5]    -0.0000473158  0.0006780769 0.0005703172  0.0017191902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.5,1.5]   -0.0004084741  0.0007663246 0.0003328309  0.0010402437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 (0.5,1.5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             -0.0004084741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-Inf,0.75]  0.0007663246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-Inf,-1]    0.0003328309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (-1,0.5]     0.0010402437</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (0.5,1.5]    0.0036116108</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $chisq</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.75265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $df</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $ML</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "polycor"</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

