<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Import Data Directly From Excel
<!-- %%  ~~function to do ... ~~ --> — XLGetRange • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Import Data Directly From Excel
<!-- %%  ~~function to do ... ~~ --> — XLGetRange" />
<meta property="og:description" content="The package RDCOMClient is used to open an Excel workbook and return the content (value) of one (or several) given range(s)
in a specified sheet. This is helpful, whenever pathologically scattered data on an Excel sheet, which can't simply be saved as CSV-file, has to be imported in R.
XLGetWorkbook() does the same for all the sheets in an Excel workbook.
" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  	<link rel="icon" href="../favicon.png" />
</head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.35</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Import Data Directly From Excel
<!-- %%  ~~function to do ... ~~ --></h1>
    
    <div class="hidden name"><code>XLGetRange.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The package <code>RDCOMClient</code> is used to open an Excel workbook and return the content (value) of one (or several) given range(s)
in a specified sheet. This is helpful, whenever pathologically scattered data on an Excel sheet, which can't simply be saved as CSV-file, has to be imported in R.<br /><br />
<code>XLGetWorkbook()</code> does the same for all the sheets in an Excel workbook.
<!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ --></p>
    </div>

    <pre class="usage"><span class='fu'>XLGetRange</span>(<span class='kw'>file</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>sheet</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>range</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>as.data.frame</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
           <span class='kw'>header</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>echo</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
           <span class='kw'>na.strings</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>skip</span> <span class='kw'>=</span> <span class='fl'>0</span>)

<span class='fu'>XLGetWorkbook</span>(<span class='no'>file</span>, <span class='kw'>compactareas</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)

<span class='fu'>XLCurrReg</span>(<span class='no'>cell</span>)
<span class='fu'>XLNamedReg</span>(<span class='no'>x</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>file</th>
      <td><p>the fully specified path and filename of the workbook. If it is left as <code>NULL</code>, the
  function will look for a running Excel-Application and use its current sheet. The parameter <code>sheet</code> will be
  ignored in this case.
<!-- %%     ~~Describe \code{fn} here~~ --></p></td>
    </tr>
    <tr>
      <th>sheet</th>
      <td><p>the name of the sheet containing the range(s) of interest.
<!-- %%     ~~Describe \code{sheet} here~~ --></p></td>
    </tr>
    <tr>
      <th>range</th>
      <td><p>a scalar or a vector with the address(es) of the range(s) to be returned (characters).
  Use "A1"-address mode to specify the ranges, for example <code>"A1:F10"</code>. <br /> If set to <code>NULL</code> (which is the default), the function will look for a selection that contains more than one cell. If
  found, the function will use this selection. If there is no selection then the current region of the selected cell will be used. Use <code>XLCurrReg()</code> if the current region of a cell, which is currently not selected, should be used. Range names can be provided with <code>XLNamedReg("name")</code>.
<!-- %%     ~~Describe \code{cellrange} here~~ --></p></td>
    </tr>
    <tr>
      <th>as.data.frame</th>
      <td><p>logical. Determines if the cellranges should be coerced into data.frames. Defaults to <code>TRUE</code>,
as this is probably the common use of this function.</p></td>
    </tr>
    <tr>
      <th>header</th>
      <td><p>a logical value indicating whether the range contains the names of the variables as its first line. Default is <code>FALSE</code>. <code>header</code> is ignored if <code>as.data.frame</code> has been set to <code>FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>stringsAsFactors</th>
      <td><p>logical. Should character columns be coerced to factors? The default is <code>FALSE</code>, which will return character vectors.</p></td>
    </tr>
    <tr>
      <th>echo</th>
      <td><p>logical. If set to <code>TRUE</code>, the function will print the full command used, such that it can be copied into the R-script for future use.</p></td>
    </tr>
    <tr>
      <th>na.strings</th>
      <td><p>a character vector of strings which are to be interpreted as <code>NA</code> values. Blank fields are always considered to be missing values. Default is <code>NULL</code>, meaning none.</p></td>
    </tr>
    <tr>
      <th>compactareas</th>
      <td><p>logical, defining if areas should be returned by <code>XLGetWorkbook</code> as list or as matrix (latter is default).</p></td>
    </tr>
    <tr>
      <th>cell</th>
      <td><p>range of the left uppe cell, when current region should be used.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>the name or the index of the XL-name to be used.</p></td>
    </tr>
    <tr>
      <th>skip</th>
      <td><p>the number of lines of the data file to skip before beginning to read data.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The result consists of a list of lists, if <code>as.data.frame</code> is set to <code>FALSE</code>.
Be then prepared to encounter <code>NULL</code> values. Those will prevent from easily being able to coerce
the square data structure to a data.frame.</p>
<p>The following code will replace the <code>NULL</code> values by <code>NA</code> and coerce the data to a data.frame.</p><pre>
  <span class='co'># get the range D1:J69 from an excel file</span>
  <span class='no'>xlrng</span> <span class='kw'>&amp;</span><span class='no'>lt</span>;- <span class='fu'>XLGetRange</span>(<span class='kw'>file</span><span class='kw'>=</span><span class='st'>"myfile.xlsx"</span>, <span class='kw'>sheet</span><span class='kw'>=</span><span class='st'>"Tabelle1"</span>,
                      <span class='kw'>range</span><span class='kw'>=</span><span class='st'>"D1:J69"</span>, <span class='kw'>as.data.frame</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

  <span class='co'># replace NULL values by NA</span>
  <span class='no'>xlrng</span>[<span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='no'>xlrng</span>, <span class='no'>is.null</span>))] <span class='kw'>&amp;</span><span class='no'>lt</span>;- <span class='fl'>NA</span>

  <span class='co'># coerce the square data structure to a data.frame</span>
  <span class='no'>d.lka</span> <span class='kw'>&amp;</span><span class='no'>lt</span>;- <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='no'>xlrng</span>), <span class='no'>unlist</span>))</pre><p>This of course can be avoided by setting <code>as.data.frame</code> = <code>TRUE</code>.</p>
<p>The function will return dates as integers, because MS-Excel stores them internally as integers.
Such a date can subsequently be converted with the (unusual) origin of
<code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date(myDate, origin="1899-12-30")</a></code>. See also <code><a href='XLDateToPOSIXct.html'>XLDateToPOSIXct</a></code>, which does the job. The conversion can directly be performed by <code>XLGetRange()</code> if <code>datecols</code> is used and contains the date columns in the sheet data.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>as.data.frame</code> is set to <code>TRUE</code>, a single data.frame or a list of data.frames will be returned.
If set to <code>FALSE</code> a list of the cell values in the specified Excel range, resp. a list of lists will be returned.</p>
<p><code>XLGetWorkbook()</code> returns a list of lists of the values in the given workbook.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='GetNewXL.html'>GetNewXL</a></code>, <code><a href='GetCurrWrd.html'>GetCurrXL</a></code>, <code><a href='XLView.html'>XLView</a></code>
<!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ --></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


