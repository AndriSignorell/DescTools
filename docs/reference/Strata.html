<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stratified Sampling — Strata • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Stratified Sampling — Strata" />
<meta property="og:description" content="Stratified sampling with equal/unequal probabilities." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.29</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified Sampling</h1>
    
    <div class="hidden name"><code>Strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stratified sampling with equal/unequal probabilities.</p>
    </div>

    <pre class="usage"><span class='fu'>Strata</span>(<span class='no'>x</span>, <span class='kw'>stratanames</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>size</span>,
       <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"srswor"</span>, <span class='st'>"srswr"</span>, <span class='st'>"poisson"</span>, <span class='st'>"systematic"</span>),
       <span class='no'>pik</span>, <span class='kw'>description</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data frame or a matrix; its number of rows is n, the population size.</p></td>
    </tr>
    <tr>
      <th>stratanames</th>
      <td><p>vector of stratification variables.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>vector of stratum sample sizes (in the order in which the strata are given in the input
data set).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method to select units; implemented are: a) simple random
sampling without replacement (<code>"srswor"</code>), b) simple random sampling with replacement (<code>"srswr"</code>),
c) Poisson sampling (<code>"poisson"</code>), d) systematic sampling (<code>"systematic"</code>) (default is <code>"srswor"</code>).</p></td>
    </tr>
    <tr>
      <th>pik</th>
      <td><p>vector of inclusion probabilities or auxiliary information used to compute them;
this argument is only used for unequal probability sampling (Poisson and systematic). If an
auxiliary information is provided, the function uses the inclusionprobabilities function for
computing these probabilities. If the method is "srswr" and the sample size is larger than
the population size, this vector is normalized to one.</p></td>
    </tr>
    <tr>
      <th>description</th>
      <td><p>a message is printed if its value is TRUE; the message gives the number
of selected units and the number of the units in the population.
By default, the value is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function produces an object, which contains the following information:</p>
<dt>id</dt><dd><p>the identifier of the selected units.</p></dd>
<dt>stratum</dt><dd><p>the unit stratum.</p></dd>
<dt>prob</dt><dd><p>the final unit inclusion probability.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/sample.html'>sample</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example from An and Watts (New SAS procedures for Analysis of Sample Survey Data)</span>
<span class='co'># generates artificial data (a 235X3 matrix with 3 columns: state, region, income).</span>
<span class='co'># the variable "state" has 2 categories ('nc' and 'sc').</span>
<span class='co'># the variable "region" has 3 categories (1, 2 and 3).</span>
<span class='co'># the sampling frame is stratified by region within state.</span>
<span class='co'># the income variable is randomly generated</span>

<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"nc"</span>,<span class='fl'>165</span>), <span class='fl'>165</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
           <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"sc"</span>, <span class='fl'>70</span>), <span class='fl'>70</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind.data.frame</a></span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>100</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>50</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>,<span class='fl'>15</span>),
                      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>30</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>40</span>)), <span class='fl'>1000</span> * <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>235</span>))
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>m</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"state"</span>, <span class='st'>"region"</span>, <span class='st'>"income"</span>)

<span class='co'># computes the population stratum sizes</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>m</span>$<span class='no'>region</span>, <span class='no'>m</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;      nc  sc
#&gt;   1 100  30
#&gt;   2  50  40
#&gt;   3  15   0</div><div class='input'>
<span class='co'># not run</span>
<span class='co'>#     nc  sc</span>
<span class='co'>#  1 100  30</span>
<span class='co'>#  2  50  40</span>
<span class='co'>#  3  15   0</span>
<span class='co'># there are 5 cells with non-zero values</span>
<span class='co'># one draws 5 samples (1 sample in each stratum)</span>
<span class='co'># the sample stratum sizes are 10,5,10,4,6, respectively</span>
<span class='co'># the method is 'srswor' (equal probability, without replacement)</span>

<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"srswor"</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.98   80.87036    nc      1  80.87036       1   10  98
#&gt; 1.13   44.13647    nc      1  44.13647       1   10  13
#&gt; 1.9   440.75781    nc      1 440.75781       1   10   9
#&gt; 1.29  655.96816    nc      1 655.96816       1   10  29
#&gt; 1.86   20.54442    nc      1  20.54442       1   10  86
#&gt; 1.16  542.45146    nc      1 542.45146       1   10  16
#&gt; 1.8   482.35179    nc      1 482.35179       1   10   8
#&gt; 1.36  572.70453    nc      1 572.70453       1   10  36
#&gt; 1.92  253.80529    nc      1 253.80529       1   10  92
#&gt; 1.100 533.04155    nc      1 533.04155       1   10 100
#&gt; 2.102 718.01602    nc      2 718.01602       2    5 102
#&gt; 2.118 348.99159    nc      2 348.99159       2    5 118
#&gt; 2.145 959.95646    nc      2 959.95646       2    5 145
#&gt; 2.135 135.61091    nc      2 135.61091       2    5 135
#&gt; 2.112 230.09193    nc      2 230.09193       2    5 112
#&gt; 3.163 388.30586    nc      3 388.30586       3   10 163
#&gt; 3.153 662.91062    nc      3 662.91062       3   10 153
#&gt; 3.157  36.66020    nc      3  36.66020       3   10 157
#&gt; 3.160 555.29766    nc      3 555.29766       3   10 160
#&gt; 3.152 642.68356    nc      3 642.68356       3   10 152
#&gt; 3.156 270.36405    nc      3 270.36405       3   10 156
#&gt; 3.158 836.54641    nc      3 836.54641       3   10 158
#&gt; 3.155 975.16088    nc      3 975.16088       3   10 155
#&gt; 3.161 483.59321    nc      3 483.59321       3   10 161
#&gt; 3.151 394.08056    nc      3 394.08056       3   10 151
#&gt; 4.183 368.00581    sc      1 368.00581       4    4 183
#&gt; 4.176 991.83105    sc      1 991.83105       4    4 176
#&gt; 4.193 894.79894    sc      1 894.79894       4    4 193
#&gt; 4.195 548.44081    sc      1 548.44081       4    4 195
#&gt; 5.232 704.64299    sc      2 704.64299       5    6 232
#&gt; 5.225  80.48474    sc      2  80.48474       5    6 225
#&gt; 5.214 520.96277    sc      2 520.96277       5    6 214
#&gt; 5.200 290.48006    sc      2 290.48006       5    6 200
#&gt; 5.233 569.91573    sc      2 569.91573       5    6 233
#&gt; 5.229 644.60175    sc      2 644.60175       5    6 229</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div><div class='input'>

<span class='co'># The same data as in Example 1</span>
<span class='co'># the method is 'systematic' (unequal probability, without replacement)</span>
<span class='co'># the selection probabilities are computed using the variable 'income'</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>),
            <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"systematic"</span>, <span class='kw'>pik</span><span class='kw'>=</span><span class='no'>m</span>$<span class='no'>income</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.67  563.19057    nc      1 563.19057       1   10  67
#&gt; 1.93  571.54761    nc      1 571.54761       1   10  93
#&gt; 1.46  550.59951    nc      1 550.59951       1   10  46
#&gt; 1.50  333.65031    nc      1 333.65031       1   10  50
#&gt; 1.10  553.89989    nc      1 553.89989       1   10  10
#&gt; 1.73  336.51893    nc      1 336.51893       1   10  73
#&gt; 1.81  665.81094    nc      1 665.81094       1   10  81
#&gt; 1.3    55.82118    nc      1  55.82118       1   10   3
#&gt; 1.13   44.13647    nc      1  44.13647       1   10  13
#&gt; 1.56  592.34629    nc      1 592.34629       1   10  56
#&gt; 2.108 737.76557    nc      2 737.76557       2    5 108
#&gt; 2.106 232.86548    nc      2 232.86548       2    5 106
#&gt; 2.142 595.64563    nc      2 595.64563       2    5 142
#&gt; 2.140 249.62570    nc      2 249.62570       2    5 140
#&gt; 2.101 307.53812    nc      2 307.53812       2    5 101
#&gt; 3.159 888.16006    nc      3 888.16006       3   10 159
#&gt; 3.157  36.66020    nc      3  36.66020       3   10 157
#&gt; 3.152 642.68356    nc      3 642.68356       3   10 152
#&gt; 3.161 483.59321    nc      3 483.59321       3   10 161
#&gt; 3.151 394.08056    nc      3 394.08056       3   10 151
#&gt; 3.165 773.62990    nc      3 773.62990       3   10 165
#&gt; 3.160 555.29766    nc      3 555.29766       3   10 160
#&gt; 3.154 835.90480    nc      3 835.90480       3   10 154
#&gt; 3.156 270.36405    nc      3 270.36405       3   10 156
#&gt; 3.153 662.91062    nc      3 662.91062       3   10 153
#&gt; 4.182 580.40832    sc      1 580.40832       4    4 182
#&gt; 4.171 152.05055    sc      1 152.05055       4    4 171
#&gt; 4.174 414.26735    sc      1 414.26735       4    4 174
#&gt; 4.191 180.95308    sc      1 180.95308       4    4 191
#&gt; 5.224 135.38640    sc      2 135.38640       5    6 224
#&gt; 5.206 814.83794    sc      2 814.83794       5    6 206
#&gt; 5.231 344.82056    sc      2 344.82056       5    6 231
#&gt; 5.229 644.60175    sc      2 644.60175       5    6 229
#&gt; 5.203 776.36402    sc      2 776.36402       5    6 203
#&gt; 5.210 663.38892    sc      2 663.38892       5    6 210</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Andri Signorell &lt;andri [at] signorell [dot] net&gt;
<br /> rewritten based on the ideas of Yves Tille &lt;yves.tille [at] unine [dot] ch&gt; and Alina Matei &lt;alina.matei [at] unine [dot] ch&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


