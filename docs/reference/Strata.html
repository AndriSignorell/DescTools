<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stratified Sampling — Strata • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Stratified Sampling — Strata" />
<meta property="og:description" content="Stratified sampling with equal/unequal probabilities." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.29</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified Sampling</h1>
    
    <div class="hidden name"><code>Strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stratified sampling with equal/unequal probabilities.</p>
    </div>

    <pre class="usage"><span class='fu'>Strata</span>(<span class='no'>x</span>, <span class='kw'>stratanames</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>size</span>,
       <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"srswor"</span>, <span class='st'>"srswr"</span>, <span class='st'>"poisson"</span>, <span class='st'>"systematic"</span>),
       <span class='no'>pik</span>, <span class='kw'>description</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data frame or a matrix; its number of rows is n, the population size.</p></td>
    </tr>
    <tr>
      <th>stratanames</th>
      <td><p>vector of stratification variables.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>vector of stratum sample sizes (in the order in which the strata are given in the input
data set).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method to select units; implemented are: a) simple random
sampling without replacement (<code>"srswor"</code>), b) simple random sampling with replacement (<code>"srswr"</code>),
c) Poisson sampling (<code>"poisson"</code>), d) systematic sampling (<code>"systematic"</code>) (default is <code>"srswor"</code>).</p></td>
    </tr>
    <tr>
      <th>pik</th>
      <td><p>vector of inclusion probabilities or auxiliary information used to compute them;
this argument is only used for unequal probability sampling (Poisson and systematic). If an
auxiliary information is provided, the function uses the inclusionprobabilities function for
computing these probabilities. If the method is "srswr" and the sample size is larger than
the population size, this vector is normalized to one.</p></td>
    </tr>
    <tr>
      <th>description</th>
      <td><p>a message is printed if its value is TRUE; the message gives the number
of selected units and the number of the units in the population.
By default, the value is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function produces an object, which contains the following information:</p>
<dt>id</dt><dd><p>the identifier of the selected units.</p></dd>
<dt>stratum</dt><dd><p>the unit stratum.</p></dd>
<dt>prob</dt><dd><p>the final unit inclusion probability.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/sample.html'>sample</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example from An and Watts (New SAS procedures for Analysis of Sample Survey Data)</span>
<span class='co'># generates artificial data (a 235X3 matrix with 3 columns: state, region, income).</span>
<span class='co'># the variable "state" has 2 categories ('nc' and 'sc').</span>
<span class='co'># the variable "region" has 3 categories (1, 2 and 3).</span>
<span class='co'># the sampling frame is stratified by region within state.</span>
<span class='co'># the income variable is randomly generated</span>

<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"nc"</span>,<span class='fl'>165</span>), <span class='fl'>165</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
           <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"sc"</span>, <span class='fl'>70</span>), <span class='fl'>70</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind.data.frame</a></span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>100</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>50</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>,<span class='fl'>15</span>),
                      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>30</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>40</span>)), <span class='fl'>1000</span> * <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>235</span>))
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>m</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"state"</span>, <span class='st'>"region"</span>, <span class='st'>"income"</span>)

<span class='co'># computes the population stratum sizes</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>m</span>$<span class='no'>region</span>, <span class='no'>m</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;      nc  sc
#&gt;   1 100  30
#&gt;   2  50  40
#&gt;   3  15   0</div><div class='input'>
<span class='co'># not run</span>
<span class='co'>#     nc  sc</span>
<span class='co'>#  1 100  30</span>
<span class='co'>#  2  50  40</span>
<span class='co'>#  3  15   0</span>
<span class='co'># there are 5 cells with non-zero values</span>
<span class='co'># one draws 5 samples (1 sample in each stratum)</span>
<span class='co'># the sample stratum sizes are 10,5,10,4,6, respectively</span>
<span class='co'># the method is 'srswor' (equal probability, without replacement)</span>

<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"srswor"</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.52   23.10093    nc      1  23.10093       1   10  52
#&gt; 1.62  761.42889    nc      1 761.42889       1   10  62
#&gt; 1.84  592.34629    nc      1 592.34629       1   10  84
#&gt; 1.9   408.09932    nc      1 408.09932       1   10   9
#&gt; 1.94  552.14334    nc      1 552.14334       1   10  94
#&gt; 1.14  980.51893    nc      1 980.51893       1   10  14
#&gt; 1.22  861.17353    nc      1 861.17353       1   10  22
#&gt; 1.71  859.76367    nc      1 859.76367       1   10  71
#&gt; 1.66  213.89583    nc      1 213.89583       1   10  66
#&gt; 1.41   44.13647    nc      1  44.13647       1   10  41
#&gt; 2.127 398.03868    nc      2 398.03868       2    5 127
#&gt; 2.126  80.87036    nc      2  80.87036       2    5 126
#&gt; 2.102 982.44097    nc      2 982.44097       2    5 102
#&gt; 2.105 267.47048    nc      2 267.47048       2    5 105
#&gt; 2.136 737.76557    nc      2 737.76557       2    5 136
#&gt; 3.157 633.58222    nc      3 633.58222       3   10 157
#&gt; 3.154 385.42599    nc      3 385.42599       3   10 154
#&gt; 3.156 794.92344    nc      3 794.92344       3   10 156
#&gt; 3.163 135.61091    nc      3 135.61091       3   10 163
#&gt; 3.158 427.83172    nc      3 427.83172       3   10 158
#&gt; 3.152 490.38595    nc      3 490.38595       3   10 152
#&gt; 3.155 616.97988    nc      3 616.97988       3   10 155
#&gt; 3.159 508.78938    nc      3 508.78938       3   10 159
#&gt; 3.151 426.00580    nc      3 426.00580       3   10 151
#&gt; 3.161 391.48706    nc      3 391.48706       3   10 161
#&gt; 4.187 888.16006    sc      1 888.16006       4    4 187
#&gt; 4.181 662.91062    sc      1 662.91062       4    4 181
#&gt; 4.173 959.95646    sc      1 959.95646       4    4 173
#&gt; 4.169 783.51664    sc      1 783.51664       4    4 169
#&gt; 5.223 548.44081    sc      2 548.44081       5    6 223
#&gt; 5.204 991.83105    sc      2 991.83105       5    6 204
#&gt; 5.197 491.80663    sc      2 491.80663       5    6 197
#&gt; 5.213 864.23243    sc      2 864.23243       5    6 213
#&gt; 5.230 836.37106    sc      2 836.37106       5    6 230
#&gt; 5.207 423.71597    sc      2 423.71597       5    6 207</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div><div class='input'>

<span class='co'># The same data as in Example 1</span>
<span class='co'># the method is 'systematic' (unequal probability, without replacement)</span>
<span class='co'># the selection probabilities are computed using the variable 'income'</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>),
            <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"systematic"</span>, <span class='kw'>pik</span><span class='kw'>=</span><span class='no'>m</span>$<span class='no'>income</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;           income state region   income.1 stratum size  id
#&gt; 1.67  941.573442    nc      1 941.573442       1   10  67
#&gt; 1.74  550.599515    nc      1 550.599515       1   10  74
#&gt; 1.50  207.669702    nc      1 207.669702       1   10  50
#&gt; 1.60  169.762922    nc      1 169.762922       1   10  60
#&gt; 1.13  379.228159    nc      1 379.228159       1   10  13
#&gt; 1.72  944.806864    nc      1 944.806864       1   10  72
#&gt; 1.93  778.014447    nc      1 778.014447       1   10  93
#&gt; 1.17   52.493456    nc      1  52.493456       1   10  17
#&gt; 1.11  854.247657    nc      1 854.247657       1   10  11
#&gt; 1.97  211.988364    nc      1 211.988364       1   10  97
#&gt; 2.150 948.044730    nc      2 948.044730       2    5 150
#&gt; 2.137 887.681510    nc      2 887.681510       2    5 137
#&gt; 2.130 718.016017    nc      2 718.016017       2    5 130
#&gt; 2.119 785.784168    nc      2 785.784168       2    5 119
#&gt; 2.146 348.991587    nc      2 348.991587       2    5 146
#&gt; 3.155 616.979882    nc      3 616.979882       3   10 155
#&gt; 3.153 507.131356    nc      3 507.131356       3   10 153
#&gt; 3.164 388.503158    nc      3 388.503158       3   10 164
#&gt; 3.152 490.385954    nc      3 490.385954       3   10 152
#&gt; 3.163 135.610908    nc      3 135.610908       3   10 163
#&gt; 3.162 352.577260    nc      3 352.577260       3   10 162
#&gt; 3.159 508.789378    nc      3 508.789378       3   10 159
#&gt; 3.151 426.005796    nc      3 426.005796       3   10 151
#&gt; 3.161 391.487057    nc      3 391.487057       3   10 161
#&gt; 3.165 172.973646    nc      3 172.973646       3   10 165
#&gt; 4.189 483.593212    sc      1 483.593212       4    4 189
#&gt; 4.173 959.956460    sc      1 959.956460       4    4 173
#&gt; 4.171 633.772600    sc      1 633.772600       4    4 171
#&gt; 4.175 982.188314    sc      1 982.188314       4    4 175
#&gt; 5.235   7.926157    sc      2   7.926157       5    6 235
#&gt; 5.196 192.331680    sc      2 192.331680       5    6 196
#&gt; 5.211 368.005813    sc      2 368.005813       5    6 211
#&gt; 5.204 991.831050    sc      2 991.831050       5    6 204
#&gt; 5.227 588.872587    sc      2 588.872587       5    6 227
#&gt; 5.210 580.408316    sc      2 580.408316       5    6 210</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Andri Signorell &lt;andri@signorell.net&gt;
<br /> rewritten based on the ideas of Yves Tille &lt;yves.tille@unine.ch&gt; and Alina Matei &lt;alina.matei@unine.ch&gt;</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


