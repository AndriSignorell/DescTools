<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Stratified Sampling — Strata • DescTools</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Stratified Sampling — Strata" />
<meta property="og:description" content="Stratified sampling with equal/unequal probabilities." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DescTools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.36.0002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">PDF:</li>
    <li>
      <a href="../articles/DescToolsCompanion.pdf">Desc Tools Companion</a>
    </li>
    <li>
      <a href="../articles/TablesInR.pdf">Tables in R</a>
    </li>
    <li>
      <a href="../articles/Combinatorics.pdf">Combinatorics</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/AndriSignorell/DescTools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Stratified Sampling</h1>
    
    <div class="hidden name"><code>Strata.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Stratified sampling with equal/unequal probabilities.</p>
    </div>

    <pre class="usage"><span class='fu'>Strata</span>(<span class='no'>x</span>, <span class='kw'>stratanames</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>size</span>,
       <span class='kw'>method</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"srswor"</span>, <span class='st'>"srswr"</span>, <span class='st'>"poisson"</span>, <span class='st'>"systematic"</span>),
       <span class='no'>pik</span>, <span class='kw'>description</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a data frame or a matrix; its number of rows is n, the population size.</p></td>
    </tr>
    <tr>
      <th>stratanames</th>
      <td><p>vector of stratification variables.</p></td>
    </tr>
    <tr>
      <th>size</th>
      <td><p>vector of stratum sample sizes (in the order in which the strata are given in the input
data set).</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>method to select units; implemented are: a) simple random
sampling without replacement (<code>"srswor"</code>), b) simple random sampling with replacement (<code>"srswr"</code>),
c) Poisson sampling (<code>"poisson"</code>), d) systematic sampling (<code>"systematic"</code>) (default is <code>"srswor"</code>).</p></td>
    </tr>
    <tr>
      <th>pik</th>
      <td><p>vector of inclusion probabilities or auxiliary information used to compute them;
this argument is only used for unequal probability sampling (Poisson and systematic). If an
auxiliary information is provided, the function uses the inclusionprobabilities function for
computing these probabilities. If the method is "srswr" and the sample size is larger than
the population size, this vector is normalized to one.</p></td>
    </tr>
    <tr>
      <th>description</th>
      <td><p>a message is printed if its value is TRUE; the message gives the number
of selected units and the number of the units in the population.
By default, the value is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function produces an object, which contains the following information:</p>
<dt>id</dt><dd><p>the identifier of the selected units.</p></dd>
<dt>stratum</dt><dd><p>the unit stratum.</p></dd>
<dt>prob</dt><dd><p>the final unit inclusion probability.</p></dd>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/r/base/sample.html'>sample</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example from An and Watts (New SAS procedures for Analysis of Sample Survey Data)</span>
<span class='co'># generates artificial data (a 235X3 matrix with 3 columns: state, region, income).</span>
<span class='co'># the variable "state" has 2 categories ('nc' and 'sc').</span>
<span class='co'># the variable "region" has 3 categories (1, 2 and 3).</span>
<span class='co'># the sampling frame is stratified by region within state.</span>
<span class='co'># the income variable is randomly generated</span>

<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"nc"</span>,<span class='fl'>165</span>), <span class='fl'>165</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>),
           <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"sc"</span>, <span class='fl'>70</span>), <span class='fl'>70</span>, <span class='fl'>1</span>, <span class='kw'>byrow</span><span class='kw'>=</span><span class='fl'>TRUE</span>))
<span class='no'>m</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind.data.frame</a></span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>100</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>,<span class='fl'>50</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>3</span>,<span class='fl'>15</span>),
                      <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>1</span>, <span class='fl'>30</span>), <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>2</span>, <span class='fl'>40</span>)), <span class='fl'>1000</span> * <span class='fu'><a href='https://rdrr.io/r/stats/Uniform.html'>runif</a></span>(<span class='fl'>235</span>))
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>m</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"state"</span>, <span class='st'>"region"</span>, <span class='st'>"income"</span>)

<span class='co'># computes the population stratum sizes</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>m</span>$<span class='no'>region</span>, <span class='no'>m</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;      nc  sc
#&gt;   1 100  30
#&gt;   2  50  40
#&gt;   3  15   0</div><div class='input'>
<span class='co'># not run</span>
<span class='co'>#     nc  sc</span>
<span class='co'>#  1 100  30</span>
<span class='co'>#  2  50  40</span>
<span class='co'>#  3  15   0</span>
<span class='co'># there are 5 cells with non-zero values</span>
<span class='co'># one draws 5 samples (1 sample in each stratum)</span>
<span class='co'># the sample stratum sizes are 10,5,10,4,6, respectively</span>
<span class='co'># the method is 'srswor' (equal probability, without replacement)</span>

<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>), <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"srswor"</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.100 142.10787    nc      1 142.10787       1   10 100
#&gt; 1.6   118.74966    nc      1 118.74966       1   10   6
#&gt; 1.88  940.18472    nc      1 940.18472       1   10  88
#&gt; 1.37  476.75226    nc      1 476.75226       1   10  37
#&gt; 1.61  116.64964    nc      1 116.64964       1   10  61
#&gt; 1.66  815.06143    nc      1 815.06143       1   10  66
#&gt; 1.19   30.95652    nc      1  30.95652       1   10  19
#&gt; 1.46  269.25720    nc      1 269.25720       1   10  46
#&gt; 1.69  269.63662    nc      1 269.63662       1   10  69
#&gt; 1.34  750.08931    nc      1 750.08931       1   10  34
#&gt; 2.118 933.18496    nc      2 933.18496       2    5 118
#&gt; 2.136 222.53513    nc      2 222.53513       2    5 136
#&gt; 2.115 347.76692    nc      2 347.76692       2    5 115
#&gt; 2.121 202.05867    nc      2 202.05867       2    5 121
#&gt; 2.123  23.17701    nc      2  23.17701       2    5 123
#&gt; 3.158 963.06344    nc      3 963.06344       3   10 158
#&gt; 3.156 414.33498    nc      3 414.33498       3   10 156
#&gt; 3.162 924.67107    nc      3 924.67107       3   10 162
#&gt; 3.163 470.69327    nc      3 470.69327       3   10 163
#&gt; 3.159 312.36488    nc      3 312.36488       3   10 159
#&gt; 3.151 920.57039    nc      3 920.57039       3   10 151
#&gt; 3.161 656.02706    nc      3 656.02706       3   10 161
#&gt; 3.164  62.96757    nc      3  62.96757       3   10 164
#&gt; 3.153 750.30281    nc      3 750.30281       3   10 153
#&gt; 3.160 596.18182    nc      3 596.18182       3   10 160
#&gt; 4.183 292.59138    sc      1 292.59138       4    4 183
#&gt; 4.182 722.01772    sc      1 722.01772       4    4 182
#&gt; 4.195 195.05467    sc      1 195.05467       4    4 195
#&gt; 4.166 742.18845    sc      1 742.18845       4    4 166
#&gt; 5.212 140.30218    sc      2 140.30218       5    6 212
#&gt; 5.199 458.56342    sc      2 458.56342       5    6 199
#&gt; 5.197 580.75133    sc      2 580.75133       5    6 197
#&gt; 5.235 105.96198    sc      2 105.96198       5    6 235
#&gt; 5.220 594.92260    sc      2 594.92260       5    6 220
#&gt; 5.201 718.81226    sc      2 718.81226       5    6 201</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div><div class='input'>

<span class='co'># The same data as in Example 1</span>
<span class='co'># the method is 'systematic' (unequal probability, without replacement)</span>
<span class='co'># the selection probabilities are computed using the variable 'income'</span>
<span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'>Strata</span>(<span class='no'>m</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"region"</span>, <span class='st'>"state"</span>), <span class='kw'>size</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>10</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>4</span>, <span class='fl'>6</span>),
            <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"systematic"</span>, <span class='kw'>pik</span><span class='kw'>=</span><span class='no'>m</span>$<span class='no'>income</span>)

<span class='co'># extracts the observed data</span>
<span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(<span class='kw'>income</span><span class='kw'>=</span><span class='no'>m</span>[<span class='no'>s</span>$<span class='no'>id</span>, <span class='st'>"income"</span>], <span class='no'>s</span>)</div><div class='output co'>#&gt;          income state region  income.1 stratum size  id
#&gt; 1.25  124.96221    nc      1 124.96221       1   10  25
#&gt; 1.59  449.16120    nc      1 449.16120       1   10  59
#&gt; 1.18  656.25815    nc      1 656.25815       1   10  18
#&gt; 1.50  371.04978    nc      1 371.04978       1   10  50
#&gt; 1.24  935.14601    nc      1 935.14601       1   10  24
#&gt; 1.74  187.67062    nc      1 187.67062       1   10  74
#&gt; 1.69  269.63662    nc      1 269.63662       1   10  69
#&gt; 1.16  907.12184    nc      1 907.12184       1   10  16
#&gt; 1.22  785.07720    nc      1 785.07720       1   10  22
#&gt; 1.15  915.77003    nc      1 915.77003       1   10  15
#&gt; 2.148 136.49195    nc      2 136.49195       2    5 148
#&gt; 2.119 759.79573    nc      2 759.79573       2    5 119
#&gt; 2.104 750.36523    nc      2 750.36523       2    5 104
#&gt; 2.122 415.22721    nc      2 415.22721       2    5 122
#&gt; 2.114 240.84917    nc      2 240.84917       2    5 114
#&gt; 3.154  67.95241    nc      3  67.95241       3   10 154
#&gt; 3.151 920.57039    nc      3 920.57039       3   10 151
#&gt; 3.164  62.96757    nc      3  62.96757       3   10 164
#&gt; 3.159 312.36488    nc      3 312.36488       3   10 159
#&gt; 3.163 470.69327    nc      3 470.69327       3   10 163
#&gt; 3.158 963.06344    nc      3 963.06344       3   10 158
#&gt; 3.153 750.30281    nc      3 750.30281       3   10 153
#&gt; 3.157 330.49882    nc      3 330.49882       3   10 157
#&gt; 3.162 924.67107    nc      3 924.67107       3   10 162
#&gt; 3.152 873.39318    nc      3 873.39318       3   10 152
#&gt; 4.171 126.99791    sc      1 126.99791       4    4 171
#&gt; 4.175 585.83823    sc      1 585.83823       4    4 175
#&gt; 4.180 703.93278    sc      1 703.93278       4    4 180
#&gt; 4.179 807.63759    sc      1 807.63759       4    4 179
#&gt; 5.214 561.47174    sc      2 561.47174       5    6 214
#&gt; 5.217 244.49491    sc      2 244.49491       5    6 217
#&gt; 5.211 961.49881    sc      2 961.49881       5    6 211
#&gt; 5.202 707.76068    sc      2 707.76068       5    6 202
#&gt; 5.221 354.30801    sc      2 354.30801       5    6 221
#&gt; 5.219 728.44139    sc      2 728.44139       5    6 219</div><div class='input'>
<span class='co'># see the result using a contigency table</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>s</span>$<span class='no'>region</span>, <span class='no'>s</span>$<span class='no'>state</span>)</div><div class='output co'>#&gt;    
#&gt;     nc sc
#&gt;   1 10  4
#&gt;   2  5  6
#&gt;   3 10  0</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Andri Signorell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


